{"version":3,"sources":["src/common/FunnyMath.js","src/common/fp.js","src/common/ElementController.js","src/plugins/draw/DrawModel.js","src/plugins/draw/group-helper.js","src/plugins/draw/wise-facedetection-helper.js","src/plugins/draw/icon-helper.js","src/modules/constants.js","src/plugins/draw/line-helper.js","src/plugins/draw/circle-helper.js","src/plugins/draw/text-helper.js","src/plugins/draw/polygon-helper.js","src/plugins/draw/arrow-image-helper.js","src/common/EventController.js","src/plugins/draw/DrawView.js","src/plugins/draw/index.js","src/plugins/customeditor/state.js","src/plugins/customeditor/fixed_ratio_state.js","src/plugins/customeditor/ractangle_state.js","src/plugins/customeditor/line_state.js","src/plugins/customeditor/index.js","src/plugins/svg_geometry_plugin_customeditor_v2.js","src/modules/svg_geometry.js","scripts/polygon.js","scripts/line.js","scripts/fixedratio.js","index.js"],"names":["module","exports","getRadian","angle","Math","PI","getSine","num","sin","getCosine","cos","pythagoreanTheorem","x1","y1","x2","y2","xLength","abs","yLength","lineLength","sqrt","pow","getAngle","atan2","getVertextAngle","a","b","c","ab","cb","dot","cross","alpha","checkLineIntersection","line1StartX","line1StartY","line1EndX","line1EndY","line2StartX","line2StartY","line2EndX","line2EndY","returnVal","denominator","numerator1","numerator2","getLineCenter","longX","shortX","longY","shortY","centerX","centerY","each","iter","list","i","len","length","loop","map","newList","item","push","filter","find","findIndex","reduce","init","pipe","_len","arguments","fns","Array","_key","res","fn","divEq","_len2","_key2","val","isUndefined","obj","negate","v","clone","_typeof","copiedObj","constructor","attr","hasOwnProperty","merge","defaultOptions","_options","newOptions","keyName","_","require","setAttr","attrName","ns","element","setAttributeNS","getAttr","getAttributeNS","setHrefAttr","removeChild","parentElement","childrenElement","appendChild","style","name","value","elem","createSVGElement","document","createElementNS","createLine","strokeWidth","createCircle","circleRadius","createRect","width","height","createText","txt","text","textContent","createGroup","createImage","imagePath","imageContainner","image","createPolygon","createUse","getBodyScroll","scroll","body","html","documentElement","scrollTop","scrollLeft","left","top","getSVGOffset","target","_target$getBoundingCl","getBoundingClientRect","getPageAxis","event","_this","_ref","pageX","pageY","_ref2","_ref3","_slicedToArray","xAxis","yAxis","getSize","clientWidth","parseInt","clientHeight","ElementController","DrawModel","draw","rootSVG","self","points","options","isAllSelected","setIsAllSelectedState","state","modifyPoints","setPoints","changeAxis","getRectangleIndex","indexList","isFlip","flip","isMirror","mirror","isMirrorAndFlip","alignCenter","parentSvgSize","firstPoint","getAxis","thirdPoint","geometryWidth","geometryHeight","changedX1","round","changedY1","changedX3","changedY3","setAxis","changeMinSizeOption","newMinSize","minSize","changeMaxSizeOption","newMaxSize","maxSize","addAxis","appendIndex","lastPoint","newPoint","offset","pointsLength","getPointsLength","appendAxis","validateAxis","validateAllPoint","movedXAxis","movedYAxis","point","getPoints","prototype","index","x","y","splice","GroupHelper","groupTag","notUseMoveTopLayer","add","remove","moveTopLayer","lastChild","insertBefore","nextSibling","append","child","apply","WiseFaceDetectionHelper","wiseFaceDetectionCircle","wiseFaceDetection","changeFillColor","fillColor","createElement","className","getElementById","e","updateCircle","radius","heightRatio","widthRatio","IconHelper","groupHelper","PLUS_IMAGE","MINUS_IMAGE","iconText","icon","clickEventHandler","leaveEventHandler","contextMenuEventHandler","createIcon","iconType","src","addEventListener","preventDefault","stopPropagation","changePosition","show","hide","opacity","onClick","callBack","onLeave","onContextMenu","MOVED_ATTR","ICON_HIDDEN_DELAY","CLICK_DETECTION_TIME","FunnyMath","_require","LineHelper","parentSvgMovedAttr","lines","tempArrForDragChecking","iconHelper","hideOpacity","hoveredLineIndex","iconHelperTimer","setDefaultColor","lineColor","setSelectColor","backupPoints","addPointInLine","call","lineIndex","drawModel","isPointsChanged","currentPoints","addLine","useLineEvent","useLineCursor","newLine","lineStrokeWidth","useEvent","bindEvent","drawView","setCursor","lineElement","fill","showPointIcon","clearTimeout","selectedLineIndex","maxPoint","pageAxis","leftAxis","rightAxis","minLineLength","setTimeout","mouseUpHandler","callCustomEvent","getData","contextMenuHandler","useOnlyRectangle","fixedRatio","selectLine","isSelected","addPoint","appendAll","line","appendAtLast","newLineElement","nextElementSibling","removeAll","getLines","setLines","_lines","CircleHelper","isLeave","hoveredPointIndex","circles","pointColor","removeCircle","circleIndex","update","addCircle","useCircleEvent","useCircleCursor","newCircle","useResizeRectangle","circleElement","onmousedown","selectCircle","onmouseup","customDraw","customContextmenu","showDeleteIcon","hideDeleteIconWithDelay","hideDeleteIcon","selectedCircleIndex","minPoint","isMouseLeave","nodeName","reset","changeActiveStatus","circle","changeRadius","circleLength","newCircleElement","textInCircle","getCircles","setCircles","_circles","TextTagHelper","textTag","addText","circleHelper","lastCircle","getTextTag","setTextTag","_textTag","PolygonHelper","polygon","addPolygon","selectPolygon","fillOpacity","getPolygon","setPolygon","_polygon","ArrowImageHelper","IMAGE_WIDTH","IMAGE_HEIGHT","NORMAL_IMAGE","PRESS_IMAGE","NORMAL_ALL_IMAGE","PRESS_ALL_IMAGE","arrowImageContainner","arrowImage","halfArrowWidth","halfArrowHeight","arrowTextContainner","arrowText","arrowQueue","arrowQueueLength","arrowScope","currentArrow","setArrowScope","startIndex","arrow","min","endIndex","max","getNextArrow","nextIndex","addArrowGuideText","changeArrowGuideText","textHalfWidth","textHalfHeight","getXAxisOfText","getYAxisOfText","axis","addImage","useArrow","mode","createdImage","changeArrow","changeArrowImage","changeArrowImagePath","getArrow","startAxis","endAxis","textAngle","degree","lineCenter","notUseAutoChangeOfArrow","concat","onclick","onmouseleave","resetData","callback","unbindEvent","removeEventListener","bindBodyEvent","unbindBodyEvent","EventController","DrawView","TEXT_POINT_RADIUS","parentSvgRatio","parentSvgStartAxis","selectedPolygon","wiseFaceDetectionHelper","lineHelper","textTagHelper","polygonHelper","arrowImageHelper","polygonPoint","endAxisIndex","_points$index","_points$endAxisIndex","pointAxis","circleXAxis","circleYAxis","rectangleIndex","replace","secondPoint","thridPoint","resetAllColor","setAllColor","useCursor","resetCursor","appendDom","resetParentSvgAttr","window","removeAllElement","newCircleRadius","eventName","arg","method","isArray","createArrow","arrowOptions","toggleDraggingStatus","statusType","classList","resetElementStatus","forEach","parentSVGMouseUpHandle","parentSVGMouseDownHandle","idx","ratio","useRectangleForCustomDraw","moveRectangle","_draw$drawModel$getAx","_draw$drawModel$getAx2","_ElementController$ge","_ElementController$ge2","changedX2","changedY2","validateGeometrySize","moveFixedRect","totalMovement","incrementXAxis","parentSVGMouseMoveHandle","offsetWidth","offsetHeight","prevPoints","changeRectangle","_toConsumableArray","leftAxisIndex","rightAxisIndex","ii","validateStabilization","isMoveOk","initCenter","endDraw","changeRectangleToSize","flagForchangeFirstAxis","changeNormalStatus","Draw","MINIMUM_ANGLE","active","normal","destroy","stopEvent","startEvent","changeWFDFillColor","validateIntersection","validateMinimumAngle","vertextAngle","shift","console","warn","firstLineFirstPoint","firstLineSecondPoint","j","secondLineFirstPoint","secondLineSecondPointIndex","secondLineSecondPoint","info","convertRectanglePoints","callStartEvent","start","callEndEvent","end","currentPoint","destory","isFirst","State","_classCallCheck","_init","_rootSVG","_obj","_currentPoint","_createClass","key","_start2","_end2","isLast","_destroy2","FixedRatioState","_State","_callSuper","_inherits","_get","_getPrototypeOf","RectangleState","LineState","validateAllAxis","getState","calibrateOptions","eventListener","unbindContextMenu","unbindESCkeyEvent","bindContextMenu","stopDrawing","bindESCkeyEvent","keyCode","startDraw","StateConstructor","o","Symbol","iterator","instance","Constructor","TypeError","_defineProperties","props","descriptor","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","protoProps","staticProps","t","_toPrimitive","r","toPrimitive","String","Number","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","_assertThisInitialized","ReferenceError","Boolean","valueOf","get","bind","property","receiver","base","_superPropBase","desc","getOwnPropertyDescriptor","object","setPrototypeOf","getPrototypeOf","__proto__","subClass","superClass","create","_setPrototypeOf","p","CustomEditor","CustomEditorV2","_CustomEditor","_mouseDownTimer","_svgObj","parentSVGClickHandle","createParentSVGClickHandle","_this2","createParentSVGMouseDownHandle","createParentSVGMouseUpHandle","bindCancelEvent","handleESCKey","unbindCancelEvent","removeDrawingGeometry","_state","restartDrawing","endDragEvent","_this3","isCheckingDragEvent","abortCheckingDragEvent","isRightMouseBtn","buttons","isUsingParent","_this4","isNotCurrentTarget","currentTarget","startCheckingDragEvent","_this5","startDragEvent","DEFAULT_OBJECT_SIZE","customEditor","SVGGeometry","customEditorV2","Polygon","svgTag","svgGeometry","polygonObject","mouseup","polygoncontextmenu","alert","data","log","innerHTML","Line","lineObject","FixedRatio","kindSVGObj","kindSVGDrawing","onload","getElem","id","colorFactory","red","blue","includeArea","excludeArea","getROIOptions","getLineOptions","roi","roiEditor","roiOptions","roiObj","selectROIObj","defaultROIPoints","virtualLine","virtualLineEditor","virtualLineOptions","virtualLineObj","defaultVirtualLinePoints","selectLineObj"],"mappings":"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","file":"src.06c530df.js","sourceRoot":"..\\src","sourcesContent":["module.exports = {\r\n  getRadian: function (angle) {\r\n    return angle * (Math.PI / 180)\r\n  },\r\n  getSine: function (num) {\r\n    return Math.sin(this.getRadian(num))\r\n  },\r\n  getCosine: function (num) {\r\n    return Math.cos(this.getRadian(num))\r\n  },\r\n  pythagoreanTheorem: function (x1, y1, x2, y2) {\r\n    var xLength = Math.abs(x1 - x2)\r\n    var yLength = Math.abs(y1 - y2)\r\n    /**\r\n     * It is Pythagorean theorem.\r\n     * Math.pow(a, 2) + Math.pow(b, 2) = Math.pow(c, 2)\r\n     */\r\n    var lineLength = Math.sqrt(\r\n      Math.pow(xLength, 2) + Math.pow(yLength, 2)\r\n    )\r\n\r\n    return lineLength\r\n  },\r\n  getAngle: function (x1, y1, x2, y2) {\r\n    var xLength = x1 - x2\r\n    var yLength = y1 - y2\r\n    var angle = Math.atan2(xLength, yLength)\r\n\r\n    angle *= 180 / Math.PI\r\n    angle *= -1\r\n\r\n    return angle\r\n  },\r\n  getVertextAngle: function (a, b, c) {\r\n    var ab = [\r\n      b[0] - a[0],\r\n      b[1] - a[1]\r\n    ]\r\n    var cb = [\r\n      b[0] - c[0],\r\n      b[1] - c[1]\r\n    ]\r\n    var dot = (ab[0] * cb[0] + ab[1] * cb[1]) // dot product\r\n    var cross = (ab[0] * cb[1] - ab[1] * cb[0]) // cross product\r\n    var alpha = Math.atan2(cross, dot)\r\n    return alpha * 180 / Math.PI\r\n  },\r\n  checkLineIntersection: function (line1StartX, line1StartY, line1EndX, line1EndY, line2StartX, line2StartY, line2EndX, line2EndY) {\r\n    var returnVal = true\r\n    var denominator = ((line2EndY - line2StartY) * (line1EndX - line1StartX)) - ((line2EndX - line2StartX) * (line1EndY - line1StartY))\r\n\r\n    if (denominator === 0) {\r\n      return returnVal\r\n    }\r\n    var a = line1StartY - line2StartY\r\n    var b = line1StartX - line2StartX\r\n    var numerator1 = ((line2EndX - line2StartX) * a) - ((line2EndY - line2StartY) * b)\r\n    var numerator2 = ((line1EndX - line1StartX) * a) - ((line1EndY - line1StartY) * b)\r\n    a = numerator1 / denominator\r\n    b = numerator2 / denominator\r\n    /*\r\n    // it is worth noting that this should be the same as:\r\n    x = line2StartX + (b * (line2EndX - line2StartX));\r\n    y = line2StartX + (b * (line2EndY - line2StartY));\r\n    */\r\n    // if line1 is a segment and line2 is infinite, they intersect if:\r\n    // if line2 is a segment and line1 is infinite, they intersect if:\r\n    if ((a > 0 && a < 1) && (b > 0 && b < 1)) {\r\n      returnVal = false\r\n    }\r\n    return returnVal\r\n  },\r\n  getLineCenter: function (x1, y1, x2, y2) {\r\n    var longX = 0\r\n    var shortX = 0\r\n    var longY = 0\r\n    var shortY = 0\r\n    var centerX = 0\r\n    var centerY = 0\r\n\r\n    if (x1 > x2) {\r\n      longX = x1\r\n      shortX = x2\r\n    } else {\r\n      longX = x2\r\n      shortX = x1\r\n    }\r\n\r\n    if (y1 > y2) {\r\n      longY = y1\r\n      shortY = y2\r\n    } else {\r\n      longY = y2\r\n      shortY = y1\r\n    }\r\n\r\n    centerX = (longX - shortX) / 2 + shortX\r\n    centerY = (longY - shortY) / 2 + shortY\r\n\r\n    return [centerX, centerY]\r\n  }\r\n}\r\n","const each = iter => (list) => {\r\n  for (let i = 0, len = list.length; i < len; i++) {\r\n    iter(list[i], i, list, len)\r\n  }\r\n  return list\r\n}\r\nconst loop = iter => len => {\r\n  for (let i = 0; i < len; i++) {\r\n    iter(i, len)\r\n  }\r\n  return len\r\n}\r\nconst map = iter => list => {\r\n  const newList = []\r\n  each(item => {\r\n    newList.push(iter(item))\r\n  })(list)\r\n  return newList\r\n}\r\nconst filter = iter => list => {\r\n  const newList = []\r\n  each(item => {\r\n    if (iter(item)) {\r\n      newList.push(item)\r\n    }\r\n  })(list)\r\n  return newList\r\n}\r\nconst find = iter => list => {\r\n  for (let i = 0, len = list.length; i < len; i++) {\r\n    if (iter(list[i], i, list)) return list[i]\r\n  }\r\n  return null\r\n}\r\nconst findIndex = iter => list => {\r\n  for (let i = 0, len = list.length; i < len; i++) {\r\n    if (iter(list[i], i, list)) return i\r\n  }\r\n  return -1\r\n}\r\nconst reduce = (init, iter) => list => {\r\n  each((item) => {\r\n    init = iter(init, item)\r\n  })(list)\r\n  return init\r\n}\r\nconst pipe = (...fns) => res => {\r\n  return reduce(res, (res, fn) => fn(res))(fns)\r\n}\r\nconst divEq = (...fns) => val => { // Divided Equal\r\n  each((fn) => fn(val))(fns)\r\n  return val\r\n}\r\nconst isUndefined = (obj) => typeof obj === 'undefined'\r\nconst negate = v => !v\r\nconst clone = (obj) => {\r\n  if (typeof (obj) !== 'object') {\r\n    return obj\r\n  }\r\n\r\n  var copiedObj = obj.constructor()\r\n\r\n  for (var attr in obj) {\r\n    if (obj.hasOwnProperty(attr)) {\r\n      copiedObj[attr] = clone(obj[attr])\r\n    }\r\n  }\r\n\r\n  return copiedObj\r\n}\r\nconst merge = (defaultOptions, _options) => {\r\n  var newOptions = clone(_options)\r\n\r\n  for (var keyName in defaultOptions) {\r\n    if (isUndefined(newOptions[keyName])) {\r\n      newOptions[keyName] = defaultOptions[keyName]\r\n    }\r\n  }\r\n\r\n  return newOptions\r\n}\r\n\r\nmodule.exports = {\r\n  each,\r\n  loop,\r\n  map,\r\n  filter,\r\n  find,\r\n  findIndex,\r\n  reduce,\r\n  pipe,\r\n  divEq,\r\n  isUndefined,\r\n  negate,\r\n  clone,\r\n  merge\r\n}\r\n","/**\r\n * DOM 조작 객체\r\n */\r\nconst _ = require('./fp')\r\n\r\nmodule.exports = {\r\n  setAttr (attrName, val, ns) {\r\n    !!ns && (ns = null)\r\n    return (element) => {\r\n      element.setAttributeNS(ns, attrName, val)\r\n      return element\r\n    }\r\n  },\r\n  getAttr: (attrName) => (element) => element.getAttributeNS(null, attrName),\r\n  setHrefAttr: function (val) {\r\n    return this.setAttr('href', val, 'http://www.w3.org/1999/xlink')\r\n  },\r\n  removeChild: function (parentElement, childrenElement) {\r\n    parentElement.removeChild(childrenElement)\r\n  },\r\n  appendChild: function (parentElement, childrenElement) {\r\n    parentElement.appendChild(childrenElement)\r\n  },\r\n  style (name, value) {\r\n    return elem => {\r\n      elem.style[name] = value\r\n      return elem\r\n    }\r\n  },\r\n  createSVGElement: function (name) {\r\n    return document.createElementNS('http://www.w3.org/2000/svg', name)\r\n  },\r\n  createLine: function (strokeWidth) {\r\n    return _.pipe(\r\n      this.createSVGElement,\r\n      _.divEq(\r\n        this.setAttr('stroke-width', strokeWidth),\r\n        this.setAttr('draggable', false)\r\n      )\r\n    )('line')\r\n  },\r\n  createCircle: function (circleRadius) {\r\n    return _.pipe(\r\n      this.createSVGElement,\r\n      _.divEq(\r\n        this.setAttr('r', circleRadius),\r\n        this.setAttr('draggable', false)\r\n      )\r\n    )('circle')\r\n  },\r\n  createRect: function (width, height) {\r\n    return _.pipe(\r\n      this.createSVGElement,\r\n      _.divEq(\r\n        this.setAttr('width', width),\r\n        this.setAttr('height', height),\r\n        this.setAttr('draggable', false)\r\n      )\r\n    )('rect')\r\n  },\r\n  createText: function (txt) {\r\n    return _.pipe(\r\n      this.createSVGElement,\r\n      this.setAttr('draggable', false),\r\n      (text) => {\r\n        text.textContent = txt\r\n        return text\r\n      }\r\n    )('text')\r\n  },\r\n  createGroup: function () {\r\n    return this.createSVGElement('g')\r\n  },\r\n  createImage: function (imagePath, width, height) {\r\n    var imageContainner = this.createGroup()\r\n    var image = _.pipe(\r\n      this.createSVGElement,\r\n      _.divEq(\r\n        this.setHrefAttr(imagePath),\r\n        this.setAttr('width', width),\r\n        this.setAttr('height', height),\r\n        this.setAttr('draggable', false)\r\n      )\r\n    )('image')\r\n\r\n    imageContainner.appendChild(image)\r\n\r\n    return [image, imageContainner]\r\n  },\r\n  createPolygon: function () {\r\n    return _.pipe(\r\n      this.createSVGElement,\r\n      this.setAttr('draggable', false)\r\n    )('polygon')\r\n  },\r\n  createUse: function () {\r\n    return this.createSVGElement('use')\r\n  },\r\n  getBodyScroll: function () {\r\n    var scroll = false\r\n    var body = document.body\r\n    var html = document.documentElement\r\n\r\n    if (body.scrollTop !== 0 || body.scrollLeft !== 0) {\r\n      // For Chrome, Safari, Opera\r\n      scroll = {\r\n        left: body.scrollLeft,\r\n        top: body.scrollTop\r\n      }\r\n    } else if (html.scrollTop !== 0 || html.scrollLeft !== 0) {\r\n      // Firefox, IE\r\n      scroll = {\r\n        left: html.scrollLeft,\r\n        top: html.scrollTop\r\n      }\r\n    }\r\n\r\n    return scroll\r\n  },\r\n  getSVGOffset (target) {\r\n    return () => {\r\n      const {\r\n        top, left, width, height\r\n      } = target.getBoundingClientRect()\r\n\r\n      return {\r\n        top, left, width, height\r\n      }\r\n    }\r\n  },\r\n  getPageAxis (element, event) {\r\n    return _.pipe(\r\n      this.getSVGOffset(element),\r\n      ({left, top}) => {\r\n        return [\r\n          event.pageX - left,\r\n          event.pageY - top\r\n        ]\r\n      },\r\n      ([xAxis, yAxis]) => {\r\n        const scroll = this.getBodyScroll()\r\n\r\n        if (scroll) {\r\n          xAxis -= scroll.left\r\n          yAxis -= scroll.top\r\n        }\r\n\r\n        return [xAxis, yAxis]\r\n      }\r\n    )()\r\n  },\r\n  getSize (element) {\r\n    const width = _.pipe(\r\n      this.getAttr('width'),\r\n      (width) => {\r\n        return width || element.clientWidth\r\n      },\r\n      parseInt\r\n    )(element)\r\n\r\n    const height = _.pipe(\r\n      this.getAttr('height'),\r\n      (height) => {\r\n        return height || element.clientHeight\r\n      },\r\n      parseInt\r\n    )(element)\r\n\r\n    return { width, height }\r\n  }\r\n}\r\n","const ElementController = require('../../common/ElementController')\r\nconst _ = require('../../common/fp')\r\n\r\nfunction DrawModel (draw, rootSVG) {\r\n  var self = this\r\n  this.points = _.clone(draw.options.points)\r\n  this.isAllSelected = false\r\n  this.setIsAllSelectedState = function (state) {\r\n    this.isAllSelected = state\r\n  }\r\n  this.modifyPoints = function (points) {\r\n    this.setPoints(points)\r\n    // Notify\r\n    draw.changeAxis()\r\n  }\r\n  this.getRectangleIndex = function () {\r\n    var indexList = []\r\n    var isFlip = draw.options.flip\r\n    var isMirror = draw.options.mirror\r\n    var isMirrorAndFlip = isFlip && isMirror\r\n\r\n    indexList[0] = isMirrorAndFlip ? 2 : (isFlip ? 1 : (isMirror ? 3 : 0))\r\n    indexList[1] = isMirrorAndFlip ? 3 : (isFlip ? 0 : (isMirror ? 2 : 1))\r\n    indexList[2] = isMirrorAndFlip ? 0 : (isFlip ? 3 : (isMirror ? 1 : 2))\r\n    indexList[3] = isMirrorAndFlip ? 1 : (isFlip ? 2 : (isMirror ? 0 : 3))\r\n\r\n    return indexList\r\n  }\r\n  this.alignCenter = function () {\r\n    var parentSvgSize = ElementController.getSize(rootSVG)\r\n    var firstPoint = self.getAxis(0)\r\n    var thirdPoint = self.getAxis(2)\r\n    var geometryWidth = thirdPoint[0] - firstPoint[0]\r\n    var geometryHeight = thirdPoint[1] - firstPoint[1]\r\n\r\n    var changedX1 = Math.round(parentSvgSize.width / 2 - geometryWidth / 2)\r\n    var changedY1 = Math.round(parentSvgSize.height / 2 - geometryHeight / 2)\r\n    var changedX3 = changedX1 + geometryWidth\r\n    var changedY3 = changedY1 + geometryHeight\r\n\r\n    self.setAxis(0, changedX1, changedY1)\r\n    self.setAxis(1, changedX1, changedY3)\r\n    self.setAxis(2, changedX3, changedY3)\r\n    self.setAxis(3, changedX3, changedY1)\r\n\r\n    draw.changeAxis()\r\n  }\r\n  this.changeMinSizeOption = function (newMinSize) {\r\n    draw.options.minSize = _.clone(newMinSize)\r\n  }\r\n  this.changeMaxSizeOption = function (newMaxSize) {\r\n    draw.options.maxSize = _.clone(newMaxSize)\r\n  }\r\n  this.addAxis = function (xAxis, yAxis, appendIndex) {\r\n    var lastPoint = null\r\n    var newPoint = null\r\n\r\n    var offset = ElementController.getSVGOffset(rootSVG)()\r\n\r\n    var pointsLength = this.getPointsLength()\r\n\r\n    if (_.isUndefined(xAxis) && _.isUndefined(yAxis)) {\r\n      lastPoint = this.getAxis(pointsLength - 1)\r\n      newPoint = [lastPoint[0], lastPoint[1]]\r\n      newPoint[0] += draw.options.circleRadius\r\n      newPoint[1] += draw.options.circleRadius\r\n\r\n      if (newPoint[0] < 0) {\r\n        newPoint[0] = 0\r\n      }\r\n      if (newPoint[1] < 0) {\r\n        newPoint[1] = 0\r\n      }\r\n      if (newPoint[0] > offset.width) {\r\n        newPoint[0] = offset.width\r\n      }\r\n      if (newPoint[1] > offset.height) {\r\n        newPoint[1] = offset.height\r\n      }\r\n    } else {\r\n      newPoint = [xAxis, yAxis]\r\n    }\r\n\r\n    if (_.negate(_.isUndefined(appendIndex))) {\r\n      this.appendAxis(appendIndex, newPoint[0], newPoint[1])\r\n    } else {\r\n      this.setAxis(pointsLength, newPoint[0], newPoint[1])\r\n    }\r\n  }\r\n  this.validateAxis = function (xAxis, yAxis) {\r\n    var offset = ElementController.getSVGOffset(rootSVG)()\r\n    var returnVal = true\r\n\r\n    if (\r\n      xAxis < 0 ||\r\n      yAxis < 0 ||\r\n      xAxis > offset.width ||\r\n      yAxis > offset.height\r\n    ) {\r\n      returnVal = false\r\n    }\r\n\r\n    return returnVal\r\n  }\r\n  this.validateAllPoint = function (movedXAxis, movedYAxis) {\r\n    return !_.find(point => {\r\n      return !this.validateAxis(point[0] + movedXAxis, point[1] + movedYAxis)\r\n    })(this.getPoints())\r\n  }\r\n}\r\nDrawModel.prototype = {\r\n  setPoints: function (points) {\r\n    this.points = _.clone(points)\r\n  },\r\n  getPoints: function () {\r\n    return _.clone(this.points)\r\n  },\r\n  getPointsLength: function () {\r\n    return this.points.length\r\n  },\r\n  setAxis: function (index, x, y) {\r\n    this.points[index] = [x, y]\r\n  },\r\n  appendAxis: function (index, x, y) {\r\n    this.points.splice(index, 0, [x, y])\r\n  },\r\n  getAxis: function (index) {\r\n    return this.points[index]\r\n  }\r\n}\r\n\r\nmodule.exports = DrawModel","'use strict'\r\n\r\n/**\r\n * Group 태그 Helper\r\n */\r\nconst ElementController = require('../../common/ElementController')\r\nconst _ = require('../../common/fp')\r\n\r\nmodule.exports = function GroupHelper (draw, rootSVG) { // eslint-disable-line\r\n  var groupTag = null\r\n  var notUseMoveTopLayer = draw.options.notUseMoveTopLayer\r\n\r\n  this.add = function () {\r\n    groupTag = ElementController.createGroup()\r\n  }\r\n  this.remove = function () {\r\n    ElementController.removeChild(rootSVG, groupTag)\r\n  }\r\n  this.moveTopLayer = function () {\r\n    if (notUseMoveTopLayer === true) {\r\n      return\r\n    }\r\n    var lastChild = rootSVG.lastChild\r\n\r\n    if (lastChild !== groupTag) {\r\n      rootSVG.insertBefore(\r\n        groupTag,\r\n        lastChild.nextSibling\r\n      )\r\n    }\r\n  }\r\n  this.append = function () {\r\n    ElementController.appendChild(rootSVG, groupTag)\r\n  }\r\n  this.appendChild = function (child) {\r\n    ElementController.appendChild(groupTag, child)\r\n  }\r\n  this.removeChild = function (child) {\r\n    ElementController.removeChild(groupTag, child)\r\n  }\r\n  this.insertBefore = function () {\r\n    groupTag.insertBefore.apply(groupTag, arguments)\r\n  }\r\n}\r\n","/**\r\n * Wise Face Detection 헬퍼\r\n */\r\nconst ElementController = require('../../common/ElementController')\r\nconst _ = require('../../common/fp')\r\n\r\nmodule.exports = function WiseFaceDetectionHelper (draw) { // eslint-disable-line\r\n  var wiseFaceDetectionCircle = null\r\n  var wiseFaceDetection = draw.options.wiseFaceDetection\r\n\r\n  function changeFillColor (fillColor) {\r\n    ElementController.style('color', fillColor)(wiseFaceDetectionCircle)\r\n  }\r\n\r\n  function add () {\r\n    wiseFaceDetectionCircle = document.createElement('span')\r\n    wiseFaceDetectionCircle.className = 'tui tui-wn5-smile'\r\n    ElementController.style('position', 'absolute')(wiseFaceDetectionCircle)\r\n    changeFillColor(wiseFaceDetection.fillColor)\r\n  }\r\n\r\n  function append () {\r\n    try {\r\n      document.getElementById('sketchbook').appendChild(wiseFaceDetectionCircle)\r\n    } catch (e) {\r\n\r\n    }\r\n  }\r\n\r\n  function remove () {\r\n    try {\r\n      document.getElementById('sketchbook').removeChild(wiseFaceDetectionCircle)\r\n    } catch (e) {\r\n\r\n    }\r\n  }\r\n\r\n  function updateCircle (xAxis, yAxis, height) {\r\n    var radius = height / 100\r\n\r\n    if ('heightRatio' in wiseFaceDetection) {\r\n      radius *= wiseFaceDetection.heightRatio\r\n    } else if ('widthRatio' in wiseFaceDetection) {\r\n      radius *= wiseFaceDetection.widthRatio\r\n    }\r\n\r\n    _.divEq(\r\n      ElementController.style('top', (yAxis - radius) + 'px'),\r\n      ElementController.style('left', (xAxis - radius) + 'px'),\r\n      ElementController.style('fontSize', (radius * 2) + 'px')\r\n    )(wiseFaceDetectionCircle)\r\n  }\r\n\r\n  if (wiseFaceDetection !== false) {\r\n    _.isUndefined(wiseFaceDetection.fillColor) && (wiseFaceDetection.fillColor = '#dd2200')\r\n    _.isUndefined(wiseFaceDetection.heightRatio) && (wiseFaceDetection.heightRatio = 2.2)\r\n    _.isUndefined(wiseFaceDetection.widthRatio) && (wiseFaceDetection.widthRatio = false)\r\n\r\n    this.updateCircle = updateCircle\r\n    this.append = append\r\n    this.add = add\r\n    this.remove = remove\r\n    this.changeFillColor = changeFillColor\r\n  }\r\n}","/**\r\n * 포인트 추가/삭제 아이콘\r\n * @example\r\n var iconHelper = new IconHelper();\r\n  iconHelper.createIcon('+');\r\n  iconHelper.changePosition(10, 10);\r\n  iconHelper.show();\r\n\r\n  iconHelper.hide();\r\n  */\r\nconst ElementController = require('../../common/ElementController')\r\nconst _ = require('../../common/fp')\r\n\r\nmodule.exports = function IconHelper (groupHelper) { // eslint-disable-line\r\n  var PLUS_IMAGE = require('../../images/plus.svg')\r\n  var MINUS_IMAGE = require('../../images/minus.svg')\r\n\r\n  var iconText = null\r\n  var icon = null\r\n  var width = 16\r\n  var self = this\r\n  var clickEventHandler = null\r\n  var leaveEventHandler = null\r\n  var contextMenuEventHandler = null\r\n\r\n  /**\r\n   * Plus, Minus 아이콘 생성\r\n   * appendDom 시 사용\r\n   *\r\n   * @param {Boolean} iconType true: Plus icon, false: Minus icon\r\n   */\r\n  function createIcon (iconType) {\r\n    var src = iconType ? PLUS_IMAGE : MINUS_IMAGE\r\n\r\n    if (icon === null) {\r\n      icon = ElementController.createRect(width, width)\r\n      iconText = ElementController.createImage(src, width, width)[0]\r\n\r\n      ElementController.setAttr('fill', '#000000')(icon)\r\n\r\n      _.each(ElementController.style('opacity', 0))([icon, iconText])\r\n\r\n      if (clickEventHandler !== null) {\r\n\r\n        _.each(ElementController.style('cursor', 'pointer'))([icon, iconText])\r\n\r\n        icon.addEventListener('click', function (event) {\r\n          event.preventDefault()\r\n          event.stopPropagation()\r\n          clickEventHandler(event)\r\n        })\r\n        iconText.addEventListener('click', function (event) {\r\n          event.preventDefault()\r\n          event.stopPropagation()\r\n          if (clickEventHandler !== null) {\r\n            clickEventHandler(event)\r\n          }\r\n        })\r\n\r\n        iconText.addEventListener('mouseleave', function (event) {\r\n          event.preventDefault()\r\n          event.stopPropagation()\r\n          if (leaveEventHandler !== null) {\r\n            leaveEventHandler(event)\r\n          }\r\n        })\r\n\r\n        iconText.addEventListener('contextmenu', function (event) {\r\n          event.preventDefault()\r\n          event.stopPropagation()\r\n          if (contextMenuEventHandler !== null) {\r\n            contextMenuEventHandler(event)\r\n          }\r\n        })\r\n      }\r\n    }\r\n\r\n    groupHelper.appendChild(icon)\r\n    groupHelper.appendChild(iconText)\r\n  };\r\n  function changePosition (x, y) {\r\n    _.divEq(\r\n      ElementController.setAttr('x', x - width / 2),\r\n      ElementController.setAttr('y', y - width / 2)\r\n    )(icon)\r\n    _.divEq(\r\n      ElementController.setAttr('x', x - width / 2),\r\n      ElementController.setAttr('y', y - width / 2),\r\n    )(iconText)\r\n  };\r\n  function show () {\r\n    _.each(ElementController.style('opacity', 1))([icon, iconText])\r\n  };\r\n  function hide () {\r\n    if (icon === null) {\r\n      return\r\n    }\r\n\r\n    if (icon.style.opacity === '1') {\r\n      _.each(ElementController.style('opacity', 0))([icon, iconText])\r\n      self.changePosition(0, 0)\r\n    }\r\n  };\r\n  function onClick (callBack) {\r\n    clickEventHandler = callBack\r\n  };\r\n  function onLeave (callBack) {\r\n    leaveEventHandler = callBack\r\n  };\r\n  function onContextMenu (callBack) {\r\n    contextMenuEventHandler = callBack\r\n  };\r\n\r\n  this.createIcon = createIcon\r\n  this.changePosition = changePosition\r\n  this.show = show\r\n  this.hide = hide\r\n  this.onClick = onClick\r\n  this.onLeave = onLeave\r\n  this.onContextMenu = onContextMenu\r\n}\r\n","exports.MOVED_ATTR = 'is-moved'\r\nexports.ICON_HIDDEN_DELAY = 2000\r\nexports.CLICK_DETECTION_TIME = 100\r\n","/**\r\n * Line 태그 Helper\r\n */\r\nconst IconHelper = require('./icon-helper')\r\nconst FunnyMath = require('../../common/FunnyMath')\r\nconst ElementController = require('../../common/ElementController')\r\nconst _ = require('../../common/fp')\r\nconst {ICON_HIDDEN_DELAY} = require('../../modules/constants')\r\n\r\nmodule.exports = function LineHelper (draw, rootSVG) { // eslint-disable-line\r\n  'use strict'\r\n  var parentSvgMovedAttr = 'is-moved'\r\n  var lines = []\r\n  var tempArrForDragChecking = []\r\n  var iconHelper = new IconHelper(draw.groupHelper)\r\n  var hideOpacity = '0.5'\r\n  var hoveredLineIndex = null\r\n  var iconHelperTimer = null\r\n\r\n  const setDefaultColor = ElementController.setAttr('stroke', draw.options.lineColor)\r\n  const setSelectColor = setDefaultColor\r\n\r\n  iconHelper.onClick(function (event) {\r\n    backupPoints() // addPointInLine에서 드래그 체크를 하기 때문에 추가\r\n    addPointInLine.call({\r\n      lineIndex: hoveredLineIndex\r\n    }, event)\r\n    iconHelper.hide()\r\n  })\r\n\r\n  iconHelper.onLeave(iconHelper.hide)\r\n\r\n  function backupPoints () {\r\n    tempArrForDragChecking = draw.drawModel.getPoints()\r\n  }\r\n\r\n  function isPointsChanged () {\r\n    var currentPoints = draw.drawModel.getPoints()\r\n    if (tempArrForDragChecking.length !== currentPoints.length) {\r\n      return false\r\n    }\r\n\r\n    return _.pipe(\r\n      _.findIndex((item, index) => {\r\n        return item[0] !== currentPoints[index][0] || item[1] !== currentPoints[index][1]\r\n      }),\r\n      (index) => {\r\n        tempArrForDragChecking = []\r\n        return index === -1\r\n      }\r\n    )(tempArrForDragChecking)\r\n  }\r\n\r\n  function addLine (useLineEvent, useLineCursor) {\r\n    var newLine = ElementController.createLine(draw.options.lineStrokeWidth)\r\n    newLine.lineIndex = lines.length\r\n    if (draw.options.useEvent === true && useLineEvent !== false) {\r\n      bindEvent(newLine)\r\n    }\r\n    setDefaultColor(newLine)\r\n    if (useLineCursor !== false) {\r\n      draw.drawView.setCursor(newLine)\r\n    }\r\n    lines.push(newLine)\r\n  }\r\n\r\n  function hide (lineElement) {\r\n    if (draw.options.fill === true) {\r\n      ElementController.style('display', 'none')(lineElement)\r\n    } else {\r\n      ElementController.style('opacity', hideOpacity)(lineElement)\r\n    }\r\n  }\r\n\r\n  function show (lineElement) {\r\n    if (draw.options.fill === true) {\r\n      ElementController.style('display', 'inline')(lineElement)\r\n    } else {\r\n      ElementController.style('opacity', 1)(lineElement)\r\n    }\r\n  }\r\n\r\n  function showPointIcon (event) {\r\n    clearTimeout(iconHelperTimer)\r\n    if (\r\n      ElementController.getAttr(parentSvgMovedAttr)(rootSVG) === 'true' || // 폴리건 드래그를 하고 있을 때\r\n      draw.selectedLineIndex !== null || // 드래그를 하고 있을 때\r\n      this.style.opacity === hideOpacity || // 선택된 오브젝트가 아닐 때\r\n      draw.drawModel.getPointsLength() >= draw.options.maxPoint) { // 최대 포인트일 때\r\n      return\r\n    }\r\n    var pageAxis = ElementController.getPageAxis(rootSVG, event)\r\n    var xAxis = pageAxis[0]\r\n    var yAxis = pageAxis[1]\r\n    var leftAxis = null\r\n    var rightAxis = null\r\n\r\n    if (draw.options.minLineLength !== false) {\r\n      leftAxis = draw.drawModel.getAxis(this.lineIndex)\r\n      rightAxis = draw.drawModel.getAxis(this.lineIndex === lines.length - 1 ? 0 : this.lineIndex + 1)\r\n\r\n      if (\r\n        FunnyMath.pythagoreanTheorem(xAxis, yAxis, leftAxis[0], leftAxis[1]) < draw.options.minLineLength ||\r\n        FunnyMath.pythagoreanTheorem(xAxis, yAxis, rightAxis[0], rightAxis[1]) < draw.options.minLineLength\r\n      ) {\r\n        return\r\n      }\r\n    }\r\n\r\n    iconHelper.changePosition(pageAxis[0], pageAxis[1])\r\n    hoveredLineIndex = this.lineIndex\r\n    iconHelper.show()\r\n\r\n    iconHelperTimer = setTimeout(function () {\r\n      iconHelper.hide()\r\n    }, ICON_HIDDEN_DELAY)\r\n  }\r\n\r\n  function mouseUpHandler () {\r\n    setTimeout(function () {\r\n      draw.callCustomEvent('mouseup', draw.getData())\r\n    })\r\n  }\r\n\r\n  function contextMenuHandler (event) {\r\n    draw.callCustomEvent('linecontextmenu', event)\r\n  }\r\n\r\n  function bindEvent (lineElement) {\r\n    lineElement.addEventListener('contextmenu', contextMenuHandler)\r\n\r\n    if (draw.options.useOnlyRectangle === false && draw.options.fixedRatio === false) {\r\n      // Add Point\r\n      lineElement.addEventListener('mousemove', showPointIcon)\r\n      if (draw.options.fill === false) {\r\n        iconHelper.onContextMenu(contextMenuHandler)\r\n\r\n        lineElement.addEventListener('mousedown', selectLine)\r\n        lineElement.addEventListener('mouseup', mouseUpHandler)\r\n        lineElement.addEventListener('mouseleave', function () {\r\n          if (this.isSelected === true) {\r\n            mouseUpHandler()\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  function addPointInLine (event) {\r\n    var pageAxis = null\r\n    var xAxis = null\r\n    var yAxis = null\r\n\r\n    if (isPointsChanged() === false) {\r\n      // console.log(\"isPointsChanged() === false return\");\r\n      return\r\n    }\r\n\r\n    if (draw.drawModel.getPointsLength() >= draw.options.maxPoint) {\r\n      // console.log(\"pointsLength >= draw.options.maxPoint return\");\r\n      return\r\n    }\r\n\r\n    pageAxis = ElementController.getPageAxis(rootSVG, event)\r\n    xAxis = pageAxis[0]\r\n    yAxis = pageAxis[1]\r\n\r\n    draw.addPoint(xAxis, yAxis, this.lineIndex + 1)\r\n\r\n    mouseUpHandler()\r\n  }\r\n\r\n  function appendAll () {\r\n    _.each(line => draw.groupHelper.appendChild(line))(lines)\r\n\r\n    iconHelper.createIcon(true)\r\n  }\r\n\r\n  function selectLine () {\r\n    setSelectColor(this)\r\n    this.isSelected = true\r\n    draw.groupHelper.moveTopLayer()\r\n    backupPoints()\r\n  }\r\n\r\n  function appendAtLast () {\r\n    var lineLength = lines.length\r\n    var newLineElement = lines[lineLength - 1]\r\n    var nextElementSibling = lines[lineLength - 2].nextElementSibling\r\n\r\n    draw.groupHelper.insertBefore(\r\n      newLineElement,\r\n      nextElementSibling\r\n    )\r\n  }\r\n\r\n  function removeAll () {\r\n    _.each(line => draw.groupHelper.removeChild(line))(lines)\r\n  }\r\n\r\n  function getLines () {\r\n    return lines\r\n  }\r\n\r\n  function setLines (_lines) {\r\n    lines = _lines\r\n  }\r\n\r\n  this.addLine = addLine\r\n  this.setDefaultColor = setDefaultColor\r\n  this.setSelectColor = setSelectColor\r\n  this.appendAll = appendAll\r\n  this.appendAtLast = appendAtLast\r\n  this.bindEvent = bindEvent\r\n  this.removeAll = removeAll\r\n  this.hide = hide\r\n  this.show = show\r\n  this.getLines = getLines\r\n  this.setLines = setLines\r\n}\r\n","/**\r\n * Polygon과 Line 꼭지점 Helper\r\n */\r\nconst IconHelper = require('./icon-helper')\r\nconst ElementController = require('../../common/ElementController')\r\nconst _ = require('../../common/fp')\r\nconst {ICON_HIDDEN_DELAY} = require('../../modules/constants')\r\n\r\nmodule.exports = function CircleHelper (draw, rootSVG) { // eslint-disable-line\r\n  var isLeave = false\r\n  var iconHelper = new IconHelper(draw.groupHelper)\r\n  var iconHelperTimer = null\r\n  var hoveredPointIndex = null\r\n  var circles = []\r\n\r\n  const setDefaultColor = ElementController.setAttr('fill', draw.options.pointColor)\r\n  const setSelectColor = setDefaultColor\r\n\r\n  iconHelper.onClick(function (event) {\r\n    iconHelper.hide()\r\n    removeCircle.call({\r\n      circleIndex: hoveredPointIndex\r\n    }, event)\r\n    update()\r\n  })\r\n\r\n  function addCircle (radius, useCircleEvent, useCircleCursor) {\r\n    var newCircle = ElementController.createRect(radius * 2, radius * 2)\r\n    if (\r\n      draw.options.useResizeRectangle === true ||\r\n      (draw.options.useEvent === true && useCircleEvent !== false)\r\n    ) {\r\n      bindEvent(newCircle)\r\n    }\r\n    setDefaultColor(newCircle)\r\n    if (useCircleCursor !== false) {\r\n      draw.drawView.setCursor(newCircle)\r\n    }\r\n\r\n    newCircle.circleIndex = circles.length\r\n    circles.push(newCircle)\r\n  }\r\n\r\n  function bindEvent (circleElement) {\r\n    circleElement.onmousedown = selectCircle\r\n    circleElement.onmouseup = function () {\r\n      isLeave = false\r\n      if (draw.options.customDraw === true) {\r\n        return\r\n      }\r\n      update()\r\n    }\r\n    circleElement.addEventListener('mouseleave', function () {\r\n      isLeave = true\r\n    })\r\n\r\n    if (draw.options.fixedRatio !== true) {\r\n      circleElement.customContextmenu = removeCircle\r\n      circleElement.addEventListener('contextmenu', function (event) {\r\n        event.preventDefault()\r\n      })\r\n      circleElement.addEventListener('mouseover', showDeleteIcon)\r\n      circleElement.addEventListener('mouseout', hideDeleteIconWithDelay)\r\n      circleElement.addEventListener('mousedown', hideDeleteIcon)\r\n    }\r\n  }\r\n\r\n  function showDeleteIcon () {\r\n    var pointsLength = draw.drawModel.getPointsLength()\r\n\r\n    if (\r\n      draw.selectedCircleIndex !== null ||\r\n      pointsLength <= draw.options.minPoint) { // 최대 포인트일 때\r\n      return\r\n    }\r\n\r\n    hoveredPointIndex = this.circleIndex\r\n\r\n    var xAxis = parseInt(ElementController.getAttr('x')(this))\r\n    var yAxis = parseInt(ElementController.getAttr('y')(this))\r\n    var width = parseInt(ElementController.getAttr('width')(this))\r\n    var height = parseInt(ElementController.getAttr('height')(this))\r\n\r\n    if (xAxis - width * 2 < 0) {\r\n      xAxis += width * 2\r\n    } else {\r\n      xAxis -= width\r\n    }\r\n\r\n    if (yAxis - width * 2 < 0) {\r\n      yAxis += height * 2\r\n    } else {\r\n      yAxis -= height\r\n    }\r\n\r\n    clearTimeout(iconHelperTimer)\r\n\r\n    iconHelper.changePosition(xAxis, yAxis)\r\n    iconHelper.show()\r\n  }\r\n\r\n  function hideDeleteIcon () {\r\n    iconHelper.hide()\r\n  }\r\n\r\n  function hideDeleteIconWithDelay () {\r\n    clearTimeout(iconHelperTimer)\r\n    iconHelperTimer = setTimeout(function () {\r\n      iconHelper.hide()\r\n    }, ICON_HIDDEN_DELAY)\r\n  }\r\n\r\n  function update () {\r\n    setTimeout(function () {\r\n      draw.callCustomEvent('mouseup', draw.getData())\r\n    })\r\n  }\r\n\r\n  function isMouseLeave () {\r\n    return isLeave\r\n  }\r\n\r\n  function removeCircle (event) {\r\n    var self = this\r\n    var points = draw.drawModel.getPoints()\r\n    var pointsLength = points.length\r\n\r\n    event.preventDefault()\r\n\r\n    if (pointsLength <= draw.options.minPoint) {\r\n      return\r\n    }\r\n\r\n    if (this.nodeName === 'text') {\r\n      self = circles[pointsLength - 1]\r\n    }\r\n\r\n    points.splice(self.circleIndex, 1)\r\n    draw.drawModel.setPoints(points)\r\n    draw.reset()\r\n    draw.init()\r\n    draw.drawView.changeActiveStatus()\r\n  }\r\n\r\n  function selectCircle () {\r\n    isLeave = false\r\n    var self = this\r\n    var pointsLength = draw.drawModel.getPointsLength()\r\n    if (this.nodeName === 'text') {\r\n      self = circles[pointsLength - 1]\r\n    }\r\n\r\n    setSelectColor(self)\r\n    self.isSelected = true\r\n    draw.drawView.setCursor(rootSVG)\r\n  }\r\n\r\n  function appendAll () {\r\n    _.each(circle => draw.groupHelper.appendChild(circle))(circles)\r\n    iconHelper.createIcon(false)\r\n  }\r\n\r\n  function changeRadius (index, radius) {\r\n    _.divEq(\r\n      ElementController.setAttr('width', radius * 2),\r\n      ElementController.setAttr('height', radius * 2)\r\n    )(circles[index])\r\n  }\r\n\r\n  function appendAtLast () {\r\n    var circleLength = circles.length\r\n    var newCircleElement = circles[circleLength - 1]\r\n    var nextElementSibling = circles[circleLength - 2].nextElementSibling\r\n\r\n    if (draw.options.textInCircle === null || nextElementSibling === null) {\r\n      draw.groupHelper.appendChild(newCircleElement)\r\n    } else {\r\n      draw.groupHelper.insertBefore(\r\n        newCircleElement,\r\n        nextElementSibling\r\n      )\r\n    }\r\n  }\r\n\r\n  function removeAll () {\r\n    _.each(circle => {\r\n      draw.groupHelper.removeChild(circle)\r\n    })(circles)\r\n  }\r\n\r\n  function getCircles () {\r\n    return circles\r\n  }\r\n\r\n  function setCircles (_circles) {\r\n    circles = _circles\r\n  }\r\n\r\n  this.addCircle = addCircle\r\n  this.bindEvent = bindEvent\r\n  this.selectCircle = selectCircle\r\n  this.setDefaultColor = setDefaultColor\r\n  this.setSelectColor = setSelectColor\r\n  this.appendAll = appendAll\r\n  this.changeRadius = changeRadius\r\n  this.appendAtLast = appendAtLast\r\n  this.removeAll = removeAll\r\n  this.update = update\r\n  this.isMouseLeave = isMouseLeave\r\n  this.hide = ElementController.style('display', 'none')\r\n  this.show = ElementController.style('display', 'inline')\r\n  this.getCircles = getCircles\r\n  this.setCircles = setCircles\r\n}\r\n","/**\r\n * Text 태그 헬퍼\r\n */\r\nconst ElementController = require('../../common/ElementController')\r\nconst _ = require('../../common/fp')\r\n\r\nmodule.exports = function TextTagHelper (draw, rootSVG) { // eslint-disable-line\r\n  var textTag = null\r\n  function addText () {\r\n    if (draw.options.textInCircle !== null) {\r\n      textTag = _.pipe(\r\n        ElementController.createText,\r\n        _.divEq(\r\n          ElementController.style('fontSize', '12px'),\r\n          draw.drawView.setCursor\r\n        )\r\n      )(draw.options.textInCircle)\r\n      bindEvent()\r\n    }\r\n  }\r\n\r\n  function bindEvent () {\r\n    var circles = draw.circleHelper.getCircles()\r\n    var pointsLength = draw.drawModel.getPointsLength()\r\n    var lastCircle = circles[pointsLength - 1]\r\n\r\n    textTag.onmousedown = lastCircle.onmousedown\r\n    textTag.onmouseup = lastCircle.onmouseup\r\n    if (draw.options.fixedRatio !== true) {\r\n      textTag.addEventListener('contextmenu', lastCircle.customContextmenu)\r\n    }\r\n  }\r\n\r\n  function append () {\r\n    if (draw.options.textInCircle !== null) {\r\n      draw.groupHelper.appendChild(textTag)\r\n    }\r\n  }\r\n\r\n  function remove () {\r\n    if (draw.options.textInCircle !== null) {\r\n      draw.groupHelper.removeChild(textTag)\r\n    }\r\n  }\r\n\r\n  function show () {\r\n    if (draw.options.textInCircle !== null) {\r\n      ElementController.style('display', 'inline')(textTag)\r\n    }\r\n  }\r\n\r\n  function hide () {\r\n    if (draw.options.textInCircle !== null) {\r\n      ElementController.style('display', 'none')(textTag)\r\n    }\r\n  }\r\n\r\n  function getTextTag () {\r\n    return textTag\r\n  }\r\n\r\n  function setTextTag (_textTag) {\r\n    textTag = _textTag\r\n  }\r\n\r\n  this.addText = addText\r\n  this.append = append\r\n  this.remove = remove\r\n  this.show = show\r\n  this.hide = hide\r\n  this.getTextTag = getTextTag\r\n  this.setTextTag = setTextTag\r\n}\r\n","/**\r\n * Polygon 태그 헬퍼\r\n */\r\nconst ElementController = require('../../common/ElementController')\r\nconst _ = require('../../common/fp')\r\n\r\nmodule.exports = function PolygonHelper (draw, rootSVG) { // eslint-disable-line\r\n  'use strict'\r\n\r\n  var polygon = null\r\n  function addPolygon () {\r\n    polygon = ElementController.createPolygon()\r\n    if (draw.options.useEvent === true) {\r\n      bindEvent(polygon)\r\n    }\r\n    draw.drawView.setCursor(polygon)\r\n  }\r\n\r\n  function append () {\r\n    if (draw.options.fill === true) {\r\n      draw.groupHelper.appendChild(polygon)\r\n    }\r\n  }\r\n\r\n  function selectPolygon () {\r\n    setSelectColor()\r\n    polygon.isSelected = true\r\n    draw.groupHelper.moveTopLayer()\r\n  }\r\n\r\n  function bindEvent () {\r\n    polygon.onmousedown = selectPolygon\r\n    /*\r\n    @date: 2016-09-19\r\n    oncontextmenu로 하면 IE에서 정상 동작을 하지 않기 때문에 삭제됨.\r\n    polygon.oncontextmenu = function(event){\r\n      draw.callCustomEvent(\"polygoncontextmenu\", event);\r\n    };\r\n    */\r\n    polygon.onmouseup = function () {\r\n      if (draw.options.customDraw === true) {\r\n        return\r\n      }\r\n      update()\r\n    }\r\n    polygon.addEventListener('mouseleave', function () {\r\n      if (polygon.isSelected === true) {\r\n        update()\r\n      }\r\n    })\r\n    polygon.addEventListener('contextmenu', function (event) {\r\n      draw.callCustomEvent('polygoncontextmenu', event)\r\n    })\r\n  }\r\n\r\n  function remove () {\r\n    if (draw.options.fill === true) {\r\n      draw.groupHelper.removeChild(polygon)\r\n    }\r\n  }\r\n\r\n  function setDefaultColor () {\r\n    if (draw.options.fill === true) {\r\n      _.divEq(\r\n        ElementController.style('fill', draw.options.fillColor),\r\n        ElementController.style('opacity', draw.options.fillOpacity)\r\n      )(polygon)\r\n    }\r\n  }\r\n\r\n  function setSelectColor () {\r\n    if (polygon === null) {\r\n      return\r\n    }\r\n\r\n    var opacity = draw.options.fillOpacity\r\n    if (opacity > 0) {\r\n      opacity = opacity + opacity * 0.5\r\n    }\r\n    ElementController.style('opacity', opacity)\r\n  }\r\n\r\n  function update () {\r\n    setTimeout(function () {\r\n      draw.callCustomEvent('mouseup', draw.getData())\r\n    })\r\n  }\r\n\r\n  function getPolygon () {\r\n    return polygon\r\n  }\r\n\r\n  function setPolygon (_polygon) {\r\n    polygon = _polygon\r\n  }\r\n\r\n  this.addPolygon = addPolygon\r\n  this.append = append\r\n  this.bindEvent = bindEvent\r\n  this.selectPolygon = selectPolygon\r\n  this.remove = remove\r\n  this.setDefaultColor = setDefaultColor\r\n  this.setSelectColor = setSelectColor\r\n  this.getPolygon = getPolygon\r\n  this.setPolygon = setPolygon\r\n}\r\n","/**\r\n * 화살표 이미지 Helper\r\n */\r\nconst ElementController = require('../../common/ElementController')\r\nconst FunnyMath = require('../../common/FunnyMath')\r\nconst _ = require('../../common/fp')\r\n\r\nmodule.exports = function ArrowImageHelper (draw, rootSVG) { // eslint-disable-line\r\n  'use strict'\r\n\r\n  var IMAGE_WIDTH = 25\r\n  var IMAGE_HEIGHT = 33\r\n\r\n  var NORMAL_IMAGE = require('../../images/btn_in-out_normal.png')\r\n  var PRESS_IMAGE = require('../../images/btn_in-out_press.png')\r\n\r\n  var NORMAL_ALL_IMAGE = require('../../images/btn_all_normal.png')\r\n  var PRESS_ALL_IMAGE = require('../../images/btn_all_press.png')\r\n\r\n  var arrowImageContainner = null\r\n  var arrowImage = null\r\n  var halfArrowWidth = IMAGE_WIDTH / 2\r\n  var halfArrowHeight = IMAGE_HEIGHT / 2\r\n  var arrowTextContainner = null\r\n  var arrowText = []\r\n\r\n  var arrowQueue = ['L', 'R', 'LR']\r\n  var arrowQueueLength = arrowQueue.length\r\n  var arrowScope = []\r\n  var currentArrow = null\r\n\r\n  // set Scope of Arrow\r\n  // @ArrowImageView\r\n  function setArrowScope () {\r\n    var startIndex = _.findIndex(arrow => arrow === draw.options.arrow.min)(arrowQueue)\r\n    var endIndex = _.findIndex(arrow => arrow === draw.options.arrow.max)(arrowQueue)\r\n\r\n    for (var i = startIndex; i <= endIndex; i++) {\r\n      arrowScope.push(arrowQueue[i])\r\n    }\r\n  }\r\n\r\n  // @ArrowImageView\r\n  function getNextArrow (arrow) {\r\n    var nextIndex = _.findIndex((item, index, list) => {\r\n      return item === arrow && list.length - 1 !== index\r\n    })(arrowScope) + 1\r\n\r\n    return arrowQueue[nextIndex]\r\n  }\r\n\r\n  // @ArrowImageView\r\n  function addArrowGuideText () {\r\n    if (draw.options.arrow === null) {\r\n      return\r\n    }\r\n    if (_.negate(_.isUndefined(draw.options.arrow.text)) && draw.options.arrow.text === true) {\r\n      arrowTextContainner = ElementController.createGroup()\r\n      arrowText[0] = ElementController.createText('A')\r\n      arrowText[1] = ElementController.createText('B')\r\n      ElementController.appendChild(arrowTextContainner, arrowText[0])\r\n      ElementController.appendChild(arrowTextContainner, arrowText[1])\r\n    }\r\n  }\r\n\r\n  function show () {\r\n    _.each(ElementController.style('display', 'inline'))([\r\n      arrowImage, arrowTextContainner\r\n    ])\r\n  }\r\n\r\n  function hide () {\r\n    _.each(ElementController.style('display', 'none'))([\r\n      arrowImage, arrowTextContainner\r\n    ])\r\n  }\r\n\r\n  function changeArrowGuideText (xAxis, yAxis, angle) {\r\n    var radius = halfArrowWidth + 20\r\n    var textHalfWidth = 4\r\n    var textHalfHeight = 6\r\n    var getXAxisOfText = function (angle) {\r\n      return FunnyMath.getCosine(angle) * radius - textHalfWidth\r\n    }\r\n\r\n    var getYAxisOfText = function (angle) {\r\n      return FunnyMath.getSine(angle) * radius + textHalfHeight\r\n    }\r\n\r\n    var axis = [{\r\n      x: getXAxisOfText(angle + 180),\r\n      y: getYAxisOfText(angle + 180)\r\n    },\r\n    {\r\n      x: getXAxisOfText(angle),\r\n      y: getYAxisOfText(angle)\r\n    }]\r\n\r\n    if (arrowTextContainner !== null) {\r\n      _.divEq(\r\n        ElementController.setAttr('x', xAxis + axis[0].x),\r\n        ElementController.setAttr('y', yAxis + axis[0].y)\r\n      )(arrowText[0])\r\n      _.divEq(\r\n        ElementController.setAttr('x', xAxis + axis[1].x),\r\n        ElementController.setAttr('y', yAxis + axis[1].y)\r\n      )(arrowText[1])\r\n    }\r\n  }\r\n\r\n  function addImage () {\r\n    if (draw.useArrow === true) {\r\n      var imagePath = draw.options.arrow.mode === arrowQueue[arrowQueueLength - 1] ? NORMAL_ALL_IMAGE : NORMAL_IMAGE\r\n      var createdImage = ElementController.createImage(imagePath, IMAGE_WIDTH, IMAGE_HEIGHT, true)\r\n      arrowImage = createdImage[0]\r\n      arrowImageContainner = createdImage[1]\r\n\r\n      addArrowGuideText()\r\n      draw.drawView.setCursor(arrowImage)\r\n      bindEvent()\r\n      changeArrow(draw.options.arrow.mode)\r\n    }\r\n  }\r\n\r\n  function changeArrow (arrow) {\r\n    currentArrow = arrow\r\n    changeArrowImage()\r\n    changeArrowImagePath()\r\n  }\r\n\r\n  function getArrow () {\r\n    return currentArrow\r\n  }\r\n\r\n  function changeArrowImage () {\r\n    var startAxis = draw.drawModel.getAxis(0)\r\n    var endAxis = draw.drawModel.getAxis(1)\r\n    var angle = FunnyMath.getAngle(startAxis[0], startAxis[1], endAxis[0], endAxis[1])\r\n    var textAngle = angle\r\n    var degree = currentArrow === arrowQueue[1] ? 90 : 270\r\n\r\n    var lineCenter = FunnyMath.getLineCenter(startAxis[0], startAxis[1], endAxis[0], endAxis[1])\r\n\r\n    var xAxis = lineCenter[0]\r\n    var yAxis = lineCenter[1]\r\n\r\n    _.divEq(\r\n      ElementController.setAttr('x', xAxis),\r\n      ElementController.setAttr('y', yAxis)\r\n    )(arrowImage)\r\n\r\n    if (draw.options.notUseAutoChangeOfArrow !== true) {\r\n      if (Math.abs(angle) > 90) {\r\n        degree = degree === 90 ? 270 : 90\r\n        textAngle -= 180\r\n      }\r\n    }\r\n\r\n    changeArrowGuideText(xAxis, yAxis, textAngle)\r\n\r\n    angle += degree\r\n\r\n    ElementController.setAttr(\r\n      'transform',\r\n      `rotate(${angle} ${xAxis} ${yAxis}) translate(${halfArrowWidth * -1},${halfArrowHeight * -1})`\r\n    )(arrowImageContainner)\r\n  }\r\n\r\n  function changeArrowImagePath () {\r\n    var imagePath = currentArrow === arrowQueue[arrowQueueLength - 1] ? NORMAL_ALL_IMAGE : NORMAL_IMAGE\r\n    ElementController.setHrefAttr(imagePath)(arrowImage)\r\n  }\r\n\r\n  function bindEvent () {\r\n    if (draw.options.useEvent === true) {\r\n      arrowImage.onclick = function (event) {\r\n        event.stopPropagation()\r\n      }\r\n\r\n      arrowImage.onmousedown = function (event) {\r\n        event.stopPropagation()\r\n\r\n        var imagePath = currentArrow === arrowQueue[arrowQueueLength - 1] ? PRESS_ALL_IMAGE : PRESS_IMAGE\r\n\r\n        arrowImage.isSelected = true\r\n        ElementController.setHrefAttr(imagePath)(arrowImage)\r\n      }\r\n\r\n      arrowImage.onmouseup = function (event) {\r\n        event.stopPropagation()\r\n\r\n        if (arrowImage.isSelected === true) {\r\n          var arrow = getNextArrow(currentArrow)\r\n\r\n          arrowImage.isSelected = false\r\n\r\n          changeArrow(arrow)\r\n\r\n          draw.callCustomEvent('mouseup', draw.getData())\r\n        }\r\n      }\r\n\r\n      arrowImage.onmouseleave = function (event) {\r\n        event.stopPropagation()\r\n\r\n        if (arrowImage.isSelected === true) {\r\n          arrowImage.onmouseup(event)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function remove () {\r\n    if (draw.useArrow === true) {\r\n      arrowImageContainner.removeChild(arrowImage)\r\n      draw.groupHelper.removeChild(arrowImageContainner)\r\n\r\n      if (arrowTextContainner !== null) {\r\n        arrowTextContainner.removeChild(arrowText[0])\r\n        arrowTextContainner.removeChild(arrowText[1])\r\n\r\n        draw.groupHelper.removeChild(arrowTextContainner)\r\n      }\r\n    }\r\n  }\r\n\r\n  function append () {\r\n    if (arrowImageContainner !== null) {\r\n      arrowImageContainner.appendChild(arrowImage)\r\n      draw.groupHelper.appendChild(arrowImageContainner)\r\n    }\r\n\r\n    if (arrowTextContainner !== null) {\r\n      arrowTextContainner.appendChild(arrowText[0])\r\n      arrowTextContainner.appendChild(arrowText[1])\r\n\r\n      draw.groupHelper.appendChild(arrowTextContainner)\r\n    }\r\n  }\r\n\r\n  if (draw.useArrow === true) {\r\n    setArrowScope()\r\n  }\r\n\r\n  function resetData () {\r\n    arrowImageContainner = null\r\n    arrowImage = null\r\n    arrowTextContainner = null\r\n    arrowText = []\r\n  }\r\n\r\n  this.addImage = addImage\r\n  this.append = append\r\n  this.remove = remove\r\n  this.getArrow = getArrow\r\n  this.changeArrowImage = changeArrowImage\r\n  this.changeArrow = changeArrow\r\n  this.show = show\r\n  this.hide = hide\r\n  this.resetData = resetData\r\n}\r\n","/**\r\n * 이벤트 조작 객체\r\n */\r\nmodule.exports = {\r\n  bindEvent (name, callback) {\r\n    return (element) => {\r\n      element.addEventListener(name, callback)\r\n      return element\r\n    }\r\n  },\r\n  unbindEvent (name, callback) {\r\n    return (element) => {\r\n      element.removeEventListener(name, callback)\r\n      return element\r\n    }\r\n  },\r\n  bindBodyEvent (name, callback) {\r\n    return this.bindEvent(name, callback)(document.body)\r\n  },\r\n  unbindBodyEvent (name, callback) {\r\n    return this.unbindEvent(name, callback)(document.body)\r\n  }\r\n}\r\n","const GroupHelper = require('./group-helper')\r\nconst WiseFaceDetectionHelper = require('./wise-facedetection-helper')\r\nconst LineHelper = require('./line-helper')\r\nconst CircleHelper = require('./circle-helper')\r\nconst TextTagHelper = require('./text-helper')\r\nconst PolygonHelper = require('./polygon-helper')\r\nconst ArrowImageHelper = require('./arrow-image-helper')\r\n\r\nconst ElementController = require('../../common/ElementController')\r\nconst FunnyMath = require('../../common/FunnyMath')\r\nconst EventController = require('../../common/EventController')\r\nconst _ = require('../../common/fp')\r\nconst {MOVED_ATTR} = require('../../modules/constants')\r\n\r\nmodule.exports = function DrawView (draw, rootSVG) { // eslint-disable-line\r\n  var TEXT_POINT_RADIUS = 1.5\r\n\r\n  var parentSvgRatio = []\r\n  var parentSvgStartAxis = null\r\n\r\n  var selectedPolygon = null\r\n\r\n  var drawView = this\r\n\r\n  draw.selectedCircleIndex = null\r\n  draw.selectedLineIndex = null\r\n\r\n  draw.groupHelper = new GroupHelper(draw, rootSVG)\r\n  draw.wiseFaceDetectionHelper = new WiseFaceDetectionHelper(draw, rootSVG)\r\n  draw.lineHelper = new LineHelper(draw, rootSVG)\r\n  draw.circleHelper = new CircleHelper(draw, rootSVG)\r\n  draw.textTagHelper = new TextTagHelper(draw, rootSVG)\r\n  draw.polygonHelper = new PolygonHelper(draw, rootSVG)\r\n  draw.arrowImageHelper = new ArrowImageHelper(draw, rootSVG)\r\n\r\n  this.getArrow = draw.arrowImageHelper.getArrow\r\n  this.changeArrow = draw.arrowImageHelper.changeArrow\r\n  this.moveTopLayer = draw.groupHelper.moveTopLayer\r\n  this.changeFillColor = draw.wiseFaceDetectionHelper.changeFillColor\r\n  this.changeAxis = function () {\r\n    var polygonPoint = ''\r\n    var height = 0\r\n    var lines = draw.lineHelper.getLines()\r\n    var circles = draw.circleHelper.getCircles()\r\n    var textTag = draw.textTagHelper.getTextTag()\r\n    var polygon = draw.polygonHelper.getPolygon()\r\n    var points = draw.drawModel.getPoints()\r\n\r\n    _.each((line, index, lines, len) => {\r\n      const endAxisIndex = draw.options.fill === true && index === len - 1 ? 0 : index + 1\r\n      const [x1, y1] = points[index]\r\n      const [x2, y2] = points[endAxisIndex]\r\n\r\n      _.divEq(\r\n        ElementController.setAttr('x1', x1),\r\n        ElementController.setAttr('y1', y1),\r\n        ElementController.setAttr('x2', x2),\r\n        ElementController.setAttr('y2', y2)\r\n      )(line)\r\n    })(lines)\r\n\r\n    _.each((circle, index, _, len) => {\r\n      var pointAxis = points[index]\r\n      var circleXAxis = pointAxis[0]\r\n      var circleYAxis = pointAxis[1]\r\n      var width = parseInt(ElementController.getAttr('width')(circle))\r\n      var height = parseInt(ElementController.getAttr('height')(circle))\r\n\r\n      /**\r\n       * 고정비 사각형일 때, 부모의 영역를 넘어갈 경우 Safari에서\r\n       * 정상적으로 Cursor가 지정이 안되므로 2px 이동 시킨다.\r\n       */\r\n      if (draw.options.fixedRatio === false && draw.options.useOnlyRectangle === false) {\r\n        circleXAxis -= width / 2\r\n        circleYAxis -= height / 2\r\n      } else if (draw.options.fixedRatio === true) {\r\n        switch (index) {\r\n          case draw.rectangleIndex[0]:\r\n            circleXAxis -= width - draw.options.lineStrokeWidth / 2\r\n            circleYAxis -= height - draw.options.lineStrokeWidth / 2\r\n            break\r\n          case draw.rectangleIndex[1]:\r\n            circleXAxis -= draw.options.lineStrokeWidth / 2\r\n            circleYAxis -= height - draw.options.lineStrokeWidth / 2\r\n            break\r\n          case draw.rectangleIndex[2]:\r\n            circleXAxis -= width - draw.options.lineStrokeWidth / 2\r\n            circleYAxis -= height - draw.options.lineStrokeWidth / 2\r\n            break\r\n          case draw.rectangleIndex[3]:\r\n            circleXAxis -= width - draw.options.lineStrokeWidth / 2\r\n            circleYAxis -= draw.options.lineStrokeWidth / 2\r\n            break\r\n        }\r\n      }\r\n\r\n      circle.setAttributeNS(null, 'x', circleXAxis)\r\n      circle.setAttributeNS(null, 'y', circleYAxis)\r\n\r\n      if (index === len - 1 && draw.options.textInCircle !== null) {\r\n        textTag.setAttributeNS(null, 'x', pointAxis[0] - 3)\r\n        textTag.setAttributeNS(null, 'y', pointAxis[1] + 4)\r\n      }\r\n\r\n      if (draw.options.fill === true) {\r\n        polygonPoint += pointAxis[0] + ',' + pointAxis[1] + ' '\r\n      }\r\n    })(circles)\r\n\r\n    if (draw.options.fill === true) {\r\n      polygon.setAttributeNS(null, 'points', polygonPoint.replace(/[\\s]{1}$/, ''))\r\n    }\r\n\r\n    if (draw.useArrow === true) {\r\n      draw.arrowImageHelper.changeArrowImage()\r\n    }\r\n\r\n    if (draw.options.wiseFaceDetection !== false) {\r\n      var firstPoint = points[0]\r\n      var secondPoint = points[1]\r\n      var thridPoint = points[2]\r\n      var xAxis = FunnyMath.getLineCenter(secondPoint[0], secondPoint[1], thridPoint[0], thridPoint[1])[0]\r\n      var yAxis = FunnyMath.getLineCenter(firstPoint[0], firstPoint[1], secondPoint[0], secondPoint[1])[1]\r\n      height = 0\r\n\r\n      if ('heightRatio' in draw.options.wiseFaceDetection) {\r\n        height = firstPoint[1] - secondPoint[1]\r\n      } else if ('widthRatio' in draw.options.wiseFaceDetection) {\r\n        height = firstPoint[0] - secondPoint[0]\r\n      }\r\n\r\n      height = Math.abs(height)\r\n\r\n      draw.wiseFaceDetectionHelper.updateCircle(xAxis, yAxis, height)\r\n    }\r\n  }\r\n  this.resetAllColor = function () {\r\n    var lines = draw.lineHelper.getLines()\r\n    var circles = draw.circleHelper.getCircles()\r\n\r\n    _.each(line => draw.lineHelper.setDefaultColor(line))(lines)\r\n    _.each(circle => draw.lineHelper.setDefaultColor(circle))(circles)\r\n\r\n    draw.polygonHelper.setDefaultColor()\r\n  }\r\n  this.setAllColor = function () {\r\n    var lines = draw.lineHelper.getLines()\r\n    var circles = draw.circleHelper.getCircles()\r\n\r\n    _.each(line => draw.lineHelper.setSelectColor(line))(lines)\r\n    _.each(circle => draw.lineHelper.setSelectColor(circle))(circles)\r\n\r\n    draw.polygonHelper.setSelectColor()\r\n  }\r\n  this.setCursor = function (element) {\r\n    ElementController.style('cursor', draw.options.useCursor ? 'pointer' : 'default')(element)\r\n  }\r\n  this.resetCursor = function (element) {\r\n    ElementController.style('cursor', 'default')(element)\r\n  }\r\n  this.createSVGElement = function () {\r\n    var radius = draw.options.circleRadius\r\n    var pointsLength = draw.drawModel.getPointsLength()\r\n    var addLine = function () {\r\n      if (draw.options.fixedRatio === true) {\r\n        draw.lineHelper.addLine(false, false)\r\n      } else {\r\n        draw.lineHelper.addLine()\r\n      }\r\n    }\r\n\r\n    _.loop((i, len) => {\r\n      if (i < len - 1) {\r\n        addLine()\r\n      } else {\r\n        if (draw.options.textInCircle !== null) {\r\n          radius *= TEXT_POINT_RADIUS\r\n        }\r\n\r\n        if (draw.options.fill === true) {\r\n          addLine()\r\n          draw.polygonHelper.addPolygon()\r\n        }\r\n      }\r\n\r\n      if (draw.options.fixedRatio === true) {\r\n        if (i === draw.rectangleIndex[2]) {\r\n          draw.circleHelper.addCircle(radius)\r\n        } else {\r\n          // Circle을 작게 그려서 안보이게 함.\r\n          draw.circleHelper.addCircle(0, false, false)\r\n        }\r\n      } else {\r\n        draw.circleHelper.addCircle(radius)\r\n      }\r\n    })(pointsLength)\r\n\r\n    draw.textTagHelper.addText()\r\n    draw.arrowImageHelper.addImage()\r\n    draw.groupHelper.add()\r\n\r\n    if (draw.options.wiseFaceDetection !== false) {\r\n      draw.wiseFaceDetectionHelper.add()\r\n    }\r\n  }\r\n  this.appendDom = function () {\r\n    // appending sequense is important.\r\n    // Group -> Polygon -> Line -> Circle -> Text\r\n    draw.groupHelper.append()\r\n    draw.polygonHelper.append()\r\n    draw.lineHelper.appendAll()\r\n    draw.circleHelper.appendAll()\r\n    draw.textTagHelper.append()\r\n    draw.arrowImageHelper.append()\r\n\r\n    if (draw.options.wiseFaceDetection !== false) {\r\n      draw.wiseFaceDetectionHelper.append()\r\n    }\r\n  }\r\n  this.resetParentSvgAttr = function () {\r\n    window.setTimeout(function () {\r\n      ElementController.setAttr(MOVED_ATTR, false)(rootSVG)\r\n    }, 100)\r\n  }\r\n  this.removeAllElement = function () {\r\n    try {\r\n      draw.lineHelper.removeAll()\r\n      draw.circleHelper.removeAll()\r\n      draw.polygonHelper.remove()\r\n      draw.textTagHelper.remove()\r\n      draw.arrowImageHelper.remove()\r\n\r\n      if (draw.options.wiseFaceDetection !== false) {\r\n        draw.wiseFaceDetectionHelper.remove()\r\n      }\r\n\r\n      draw.groupHelper.remove()\r\n    } catch (e) {\r\n      /**\r\n       * hide 후 destroy를 하면 에러가 발생을 하는 데,\r\n       * 현재 태그들이 삭제되었는 지 확인 하는 로직대신\r\n       * 예외 처리가 간단하므로 예외처리를 한다.\r\n       */\r\n    }\r\n  }\r\n  this.addPoint = function (xAxis, yAxis, appendIndex) {\r\n    var newCircleRadius = draw.options.circleRadius\r\n    var pointsLength = draw.drawModel.getPointsLength()\r\n    // Set Axis\r\n    if (_.negate(_.isUndefined(appendIndex))) {\r\n      draw.drawModel.addAxis(xAxis, yAxis, appendIndex)\r\n    } else {\r\n      draw.drawModel.addAxis(xAxis, yAxis)\r\n    }\r\n\r\n    draw.lineHelper.addLine()\r\n    draw.lineHelper.appendAtLast()\r\n\r\n    if (draw.options.textInCircle !== null) {\r\n      newCircleRadius *= TEXT_POINT_RADIUS\r\n    }\r\n\r\n    draw.circleHelper.addCircle(newCircleRadius)\r\n\r\n    draw.circleHelper.changeRadius(pointsLength - 1, draw.options.circleRadius)\r\n    draw.circleHelper.appendAtLast()\r\n\r\n    draw.changeAxis()\r\n\r\n    if (draw.drawModel.isAllSelected) {\r\n      draw.setAllColor()\r\n    }\r\n  }\r\n  this.callCustomEvent = function (eventName, arg) {\r\n    var method = ''\r\n\r\n    if (\r\n      (draw.options.useResizeRectangle === true || draw.options.useEvent === true) &&\r\n      draw.options.event !== null &&\r\n      draw.options.customDraw === false\r\n    ) {\r\n      if (eventName in draw.options.event) {\r\n        method = Array.isArray(arg) === true ? 'apply' : 'call'\r\n        draw.options.event[eventName][method](draw, arg)\r\n      }\r\n    }\r\n  }\r\n  this.createArrow = function (arrowOptions) {\r\n    draw.useArrow = true\r\n    draw.options.arrow = _.clone(arrowOptions)\r\n    draw.arrowImageHelper.addImage()\r\n    draw.changeAxis()\r\n    draw.arrowImageHelper.append()\r\n  }\r\n  this.toggleDraggingStatus = function (statusType) {\r\n    var method = statusType === true ? 'add' : 'remove'\r\n    var className = 'svg-geometry'\r\n\r\n    document.body.classList[method](className)\r\n  }\r\n  this.resetElementStatus = function () {\r\n    var lines = draw.lineHelper.getLines()\r\n    var circles = draw.circleHelper.getCircles()\r\n    var polygon = draw.polygonHelper.getPolygon()\r\n\r\n    if (draw.selectedLineIndex !== null) {\r\n      lines[draw.selectedLineIndex].isSelected = false\r\n      draw.selectedLineIndex = null\r\n    }\r\n\r\n    if (draw.selectedCircleIndex !== null) {\r\n      circles.forEach(function (circle) {\r\n        if (circle.isSelected === true) {\r\n          circle.isSelected = false\r\n        }\r\n      })\r\n\r\n      draw.selectedCircleIndex = null\r\n    }\r\n\r\n    if (draw.options.fill === true) {\r\n      polygon.isSelected = false\r\n      selectedPolygon = null\r\n    }\r\n\r\n    if (draw.drawModel.isAllSelected === false) {\r\n      draw.resetAllColor()\r\n    }\r\n\r\n    drawView.resetCursor(rootSVG)\r\n\r\n    if (draw.options.fixedRatio === true) {\r\n      parentSvgRatio = []\r\n    }\r\n\r\n    parentSvgStartAxis = null\r\n  }\r\n  this.parentSVGMouseUpHandle = function () {\r\n    drawView.toggleDraggingStatus(false)\r\n\r\n    if (draw.selectedCircleIndex !== null && draw.circleHelper.isMouseLeave()) {\r\n      draw.circleHelper.update()\r\n    }\r\n\r\n    if (draw.selectedLineIndex !== null) {\r\n      drawView.callCustomEvent('mouseup', draw.getData())\r\n    }\r\n\r\n    drawView.resetElementStatus()\r\n    drawView.resetParentSvgAttr()\r\n  }\r\n  this.parentSVGMouseDownHandle = function (event) {\r\n    var idx = 0\r\n    var len = 0\r\n    var circles = draw.circleHelper.getCircles()\r\n    var lines = draw.lineHelper.getLines()\r\n    var polygon = draw.polygonHelper.getPolygon()\r\n    const isSelected = item => item.isSelected\r\n\r\n    parentSvgStartAxis = ElementController.getPageAxis(rootSVG, event)\r\n\r\n    _.pipe(\r\n      _.findIndex(isSelected),\r\n      index => {\r\n        index > -1 && (draw.selectedCircleIndex = index)\r\n      }\r\n    )(circles)\r\n\r\n\r\n    // Check selected Line\r\n    if (draw.selectedCircleIndex === null && draw.options.fixedRatio === false) {\r\n      _.pipe(\r\n        _.findIndex(isSelected),\r\n        index => {\r\n          index > -1 && (draw.selectedLineIndex = index)\r\n        }\r\n      )\r\n    }\r\n\r\n    if (draw.options.fixedRatio === true && draw.options.ratio !== false) {\r\n      parentSvgRatio = draw.options.ratio\r\n    } else if (draw.selectedCircleIndex !== null && draw.options.fixedRatio === true) {\r\n      // 최대 공약수를 구해서 메모리 최적화 필요\r\n      parentSvgRatio = [\r\n        draw.options.points[2][0] - draw.options.points[0][0],\r\n        draw.options.points[2][1] - draw.options.points[0][1]\r\n      ]\r\n    }\r\n\r\n    if (draw.options.fill === true) {\r\n      if (polygon.isSelected === true) {\r\n        selectedPolygon = true\r\n      }\r\n    }\r\n\r\n    if (draw.options.customDraw === true) {\r\n      draw.selectedCircleIndex =\r\n        (draw.options.useOnlyRectangle === true || draw.options.useRectangleForCustomDraw === true)\r\n          ? 2\r\n          : circles.length - 1\r\n      drawView.toggleDraggingStatus(true)\r\n    } else if (\r\n      draw.selectedCircleIndex !== null ||\r\n      draw.selectedLineIndex !== null ||\r\n      selectedPolygon !== null\r\n    ) {\r\n      ElementController.setAttr(MOVED_ATTR, true)(rootSVG)\r\n      drawView.toggleDraggingStatus(true)\r\n    }\r\n  }\r\n  const moveRectangle = (event) => {\r\n    let [changedX1, changedY1] = draw.drawModel.getAxis(draw.rectangleIndex[0])\r\n    let [changedX2, changedY2] = ElementController.getPageAxis(rootSVG, event)\r\n    let thirdPoint = draw.drawModel.getAxis(draw.rectangleIndex[2])\r\n\r\n    // 가로 Min, Max Validation\r\n    if (!drawView.validateGeometrySize(\r\n        Math.abs(changedX1 - changedX2),\r\n        Math.abs(changedY1 - thirdPoint[1])\r\n      )) {\r\n      changedX2 = thirdPoint[0]\r\n    }\r\n\r\n    // 세로 Min, Max Validation\r\n    if (!drawView.validateGeometrySize(\r\n        Math.abs(changedX1 - thirdPoint[0]),\r\n        Math.abs(changedY1 - changedY2)\r\n      )) {\r\n      changedY2 = thirdPoint[1]\r\n    }\r\n    return [changedX1, changedY1, changedX2, changedY2]\r\n  }\r\n  const moveFixedRect = (event) => {\r\n    var pageAxis = ElementController.getPageAxis(rootSVG, event)\r\n    var xAxis = pageAxis[0]\r\n    var yAxis = pageAxis[1]\r\n    var firstPoint = draw.drawModel.getAxis(draw.rectangleIndex[0])\r\n\r\n    var movedXAxis = xAxis - parentSvgStartAxis[0]\r\n    var movedYAxis = yAxis - parentSvgStartAxis[1]\r\n\r\n    var totalMovement = Math.abs(movedXAxis) + Math.abs(movedYAxis)\r\n\r\n    var incrementXAxis = parentSvgRatio[0] / (parentSvgRatio[1] + parentSvgRatio[0]) * totalMovement\r\n\r\n    if (movedXAxis < 0 || movedYAxis < 0) {\r\n      incrementXAxis *= -1\r\n    }\r\n\r\n    let changedX1 = firstPoint[0]\r\n    let changedX2 = xAxis + incrementXAxis\r\n    let changedY1 = firstPoint[1]\r\n    let changedY2 = changedY1 + ((changedX2 - changedX1) * parentSvgRatio[1] / parentSvgRatio[0])\r\n\r\n    // 변경된좌표 체크\r\n    if (draw.drawModel.validateAxis(changedX2, changedY2) === false) {\r\n      /**\r\n       * @date 2017-04-24\r\n       * maxSize로 적용한 것은 최대 사이즈로 정상 적용을 위해서 이다.\r\n       * 두번재 (x,y)가 0 보다 작을 때는 최소 사이즈보다 작을 때 이므로,\r\n       * 분기를 추가 한다.\r\n       */\r\n      if (\r\n        (changedX1 === 0 && changedY1 === 0) &&\r\n        (changedX2 > 0 && changedY2 > 0)\r\n      ) {\r\n        changedX2 = draw.options.maxSize.width\r\n        changedY2 = draw.options.maxSize.height\r\n      } else {\r\n        return\r\n      }\r\n    }\r\n\r\n    // Min, Max Validation\r\n    if (!drawView.validateGeometrySize(Math.abs(changedX1 - changedX2), Math.abs(changedY1 - changedY2))) {\r\n      return\r\n    }\r\n    return [changedX1, changedY1, changedX2, changedY2]\r\n  }\r\n  this.parentSVGMouseMoveHandle = function (event) {\r\n    if (draw.options.customDraw === true && draw.selectedCircleIndex === null) {\r\n      drawView.parentSVGMouseDownHandle(event)\r\n    }\r\n\r\n    if (\r\n      draw.selectedCircleIndex === null &&\r\n      draw.selectedLineIndex === null &&\r\n      selectedPolygon === null &&\r\n      draw.options.customDraw === false\r\n    ) {\r\n      return\r\n    }\r\n\r\n    var pageAxis = ElementController.getPageAxis(rootSVG, event)\r\n    var xAxis = pageAxis[0]\r\n    var yAxis = pageAxis[1]\r\n\r\n    var movedXAxis = xAxis - parentSvgStartAxis[0]\r\n    var movedYAxis = yAxis - parentSvgStartAxis[1]\r\n\r\n    var offsetWidth = ElementController.getSVGOffset(rootSVG)().width\r\n    var offsetHeight = ElementController.getSVGOffset(rootSVG)().height\r\n\r\n    var firstPoint = draw.drawModel.getAxis(draw.rectangleIndex[0])\r\n    var thirdPoint = draw.drawModel.getAxis(draw.rectangleIndex[2])\r\n\r\n    var prevPoints = []\r\n\r\n    var pointsLength = draw.drawModel.getPointsLength()\r\n\r\n    var changedX1 = 0\r\n    var changedX2 = 0\r\n    var changedY1 = 0\r\n    var changedY2 = 0\r\n\r\n    var self = null\r\n\r\n    var circles = []\r\n    var lines = []\r\n    var polygon = null\r\n\r\n    // 포인트를 선택하여 영역을 이동 시킬 때\r\n    if (draw.selectedCircleIndex !== null) {\r\n      /*\r\n      Point 이동 시 좌표 유효성 체크\r\n      움직였을 때의 거리를 계산하여 유효성을 체크한다.\r\n      */\r\n      if (xAxis < 0) {\r\n        xAxis = 0\r\n      } else if (xAxis > offsetWidth) {\r\n        xAxis = offsetWidth\r\n      }\r\n\r\n      if (yAxis < 0) {\r\n        yAxis = 0\r\n      } else if (yAxis > offsetHeight) {\r\n        yAxis = offsetHeight\r\n      }\r\n\r\n      // 사각형 리사이징\r\n      if (draw.options.fixedRatio === true || draw.options.useRectangleForCustomDraw === true) {\r\n        // 사각형\r\n        let axis = []\r\n        if (draw.options.useOnlyRectangle === true || draw.options.useRectangleForCustomDraw === true) {\r\n          axis = moveRectangle(event)\r\n        } else { // 고정비 확대\r\n          axis = moveFixedRect(event)\r\n        }\r\n\r\n        // 뒤집어지는 것을 방지 하기 위해 세번째 포인트가 첫번째 포인트 보다 적을 때 return\r\n        if (\r\n          _.isUndefined(axis) ||\r\n          (\r\n            draw.options.useRectangleForCustomDraw === false &&\r\n            (firstPoint[0] > axis[2] || firstPoint[1] > axis[3])\r\n          )\r\n        ) {\r\n          return\r\n        }\r\n\r\n        drawView.changeRectangle(...axis)\r\n\r\n        // 라인과 폴리곤 사각형의 Circle\r\n      } else {\r\n        var validateAxis = []\r\n        var leftAxisIndex = 0\r\n        var rightAxisIndex = 0\r\n        /**\r\n         * Custom Drawing 중일 때는 Line 제한을 하지 않고,\r\n         * custom 함수에서 클릭시 제한을 한다.\r\n         */\r\n        if (\r\n          draw.options.customDraw === false &&\r\n          draw.options.minLineLength !== false) {\r\n          circles = draw.circleHelper.getCircles()\r\n\r\n          if (!(draw.options.fill === false && draw.selectedCircleIndex === 0)) {\r\n            leftAxisIndex = draw.selectedCircleIndex === 0 ? circles.length - 1 : draw.selectedCircleIndex - 1\r\n            validateAxis.push(draw.drawModel.getAxis(leftAxisIndex))\r\n          }\r\n\r\n          if (!(draw.options.fill === false && draw.selectedCircleIndex === circles.length - 1)) {\r\n            rightAxisIndex = draw.selectedCircleIndex === circles.length - 1 ? 0 : draw.selectedCircleIndex + 1\r\n            validateAxis.push(draw.drawModel.getAxis(rightAxisIndex))\r\n          }\r\n\r\n          for (var i = 0, ii = validateAxis.length; i < ii; i++) {\r\n            self = validateAxis[i]\r\n\r\n            if (FunnyMath.pythagoreanTheorem(xAxis, yAxis, self[0], self[1]) < draw.options.minLineLength) {\r\n              return\r\n            }\r\n          }\r\n        }\r\n\r\n        prevPoints = draw.drawModel.getPoints()\r\n        prevPoints[draw.selectedCircleIndex] = [xAxis, yAxis]\r\n\r\n        if (draw.validateStabilization(prevPoints) === false) {\r\n          return\r\n        }\r\n\r\n        draw.drawModel.setAxis(draw.selectedCircleIndex, xAxis, yAxis)\r\n      }\r\n      // 라인을 선택하여 이동할 때\r\n    } else if (draw.options.fill === true && draw.selectedLineIndex !== null) {\r\n      lines = draw.lineHelper.getLines()\r\n      var startAxis = draw.drawModel.getAxis(draw.selectedLineIndex)\r\n      var endAxisIndex = draw.options.fill === true && draw.selectedLineIndex === lines.length - 1 ? 0 : draw.selectedLineIndex + 1\r\n      var endAxis = draw.drawModel.getAxis(endAxisIndex)\r\n\r\n      changedX1 = startAxis[0] + movedXAxis\r\n      changedY1 = startAxis[1] + movedYAxis\r\n      changedX2 = endAxis[0] + movedXAxis\r\n      changedY2 = endAxis[1] + movedYAxis\r\n\r\n      /*\r\n       * 라인 이동 시, 양쪽 끝의 유효성 체크하여\r\n       * 변경이 불가능하면 기존 좌표로 한다.\r\n       */\r\n      if (\r\n        draw.drawModel.validateAxis(changedX1, changedY1) === false ||\r\n        draw.drawModel.validateAxis(changedX2, changedY2) === false\r\n      ) {\r\n        changedX1 = startAxis[0]\r\n        changedY1 = startAxis[1]\r\n        changedX2 = endAxis[0]\r\n        changedY2 = endAxis[1]\r\n      }\r\n\r\n      prevPoints = draw.drawModel.getPoints()\r\n      prevPoints[draw.selectedLineIndex] = [changedX1, changedY1]\r\n      prevPoints[endAxisIndex] = [changedX2, changedY2]\r\n\r\n      if (draw.validateStabilization(prevPoints) === false) {\r\n        return\r\n      }\r\n\r\n      draw.drawModel.setAxis(draw.selectedLineIndex, changedX1, changedY1)\r\n      draw.drawModel.setAxis(endAxisIndex, changedX2, changedY2)\r\n      // 영역을 선택하여 이동할 때\r\n    } else if (draw.options.fill === true || draw.selectedLineIndex !== null) {\r\n      var isMoveOk = false\r\n      polygon = draw.polygonHelper.getPolygon()\r\n\r\n      if (polygon !== null) {\r\n        isMoveOk = polygon.isSelected === true\r\n      } else {\r\n        isMoveOk = draw.selectedLineIndex !== null\r\n      }\r\n\r\n      /*\r\n      Polygon 이동 시 좌표 유효성 체크\r\n      Polygon은 도형 전체가 움직이므로 모든 Point의 좌표를 체크한다.\r\n      */\r\n      if (draw.options.useOnlyRectangle === true || draw.options.fixedRatio === true) {\r\n        if (\r\n          firstPoint[0] + movedXAxis < 0 ||\r\n          thirdPoint[0] + movedXAxis > offsetWidth) {\r\n          movedXAxis = 0\r\n        }\r\n\r\n        if (\r\n          firstPoint[1] + movedYAxis < 0 ||\r\n          thirdPoint[1] + movedYAxis > offsetHeight) {\r\n          movedYAxis = 0\r\n        }\r\n      }\r\n\r\n      if (draw.drawModel.validateAllPoint(movedXAxis, 0) === false) {\r\n        movedXAxis = 0\r\n      }\r\n\r\n      if (draw.drawModel.validateAllPoint(0, movedYAxis) === false) {\r\n        movedYAxis = 0\r\n      }\r\n      if (isMoveOk) {\r\n        _.loop(index => {\r\n          const self = draw.drawModel.getAxis(index)\r\n          draw.drawModel.setAxis(index, self[0] + movedXAxis, self[1] + movedYAxis)\r\n        })(pointsLength)\r\n      }\r\n    }\r\n\r\n    parentSvgStartAxis = [xAxis, yAxis]\r\n\r\n    // Update\r\n    draw.changeAxis()\r\n  }\r\n  this.bindEvent = function () {\r\n    if (\r\n      draw.options.useResizeRectangle === true ||\r\n      draw.options.useEvent === true ||\r\n      draw.options.customDraw === true) {\r\n      parentSvgStartAxis = null\r\n      EventController.bindBodyEvent('mousedown', drawView.parentSVGMouseDownHandle)\r\n      EventController.bindBodyEvent('mousemove', drawView.parentSVGMouseMoveHandle)\r\n      EventController.bindBodyEvent('mouseup', drawView.parentSVGMouseUpHandle)\r\n      EventController.bindBodyEvent('mouseleave', drawView.parentSVGMouseUpHandle)\r\n    }\r\n  }\r\n  this.init = function () {\r\n    drawView.createSVGElement()\r\n\r\n    if (draw.options.initCenter === true) {\r\n      draw.drawModel.alignCenter()\r\n    }\r\n\r\n    draw.changeAxis()\r\n    draw.resetAllColor()\r\n    drawView.bindEvent()\r\n    drawView.appendDom()\r\n  }\r\n  this.reset = function () {\r\n    drawView.removeAllElement()\r\n    drawView.unbindEvent()\r\n    draw.lineHelper.setLines([])\r\n    draw.circleHelper.setCircles([])\r\n    draw.polygonHelper.setPolygon(null)\r\n    draw.textTagHelper.setTextTag(null)\r\n    draw.arrowImageHelper.resetData()\r\n  }\r\n  this.unbindEvent = function () {\r\n    EventController.unbindBodyEvent('mousedown', drawView.parentSVGMouseDownHandle)\r\n    EventController.unbindBodyEvent('mousemove', drawView.parentSVGMouseMoveHandle)\r\n    EventController.unbindBodyEvent('mouseup', drawView.parentSVGMouseUpHandle)\r\n    EventController.unbindBodyEvent('mouseleave', drawView.parentSVGMouseUpHandle)\r\n    // document.documentElement.removeEventListener('mouseup', documentElementMouseMoveHandle);\r\n  }\r\n  this.endDraw = function () {\r\n    draw.options.customDraw = false\r\n    draw.options.useRectangleForCustomDraw = false\r\n    drawView.resetElementStatus()\r\n    drawView.resetParentSvgAttr()\r\n  }\r\n  this.changeRectangleToSize = function (width, height) {\r\n    if (draw.options.useOnlyRectangle !== true && draw.options.fixedRatio !== true) {\r\n      return\r\n    }\r\n\r\n    var firstPoint = draw.drawModel.getAxis(0)\r\n    var thirdPoint = draw.drawModel.getAxis(2)\r\n    var offset = ElementController.getSVGOffset(rootSVG)()\r\n    var changedX1 = 0\r\n    var changedX3 = 0\r\n    var changedY1 = 0\r\n    var changedY3 = 0\r\n\r\n    /*\r\n     * 세번째 좌표가 오른쪽 하단 끝에 있을 경우\r\n     * 세번째 좌표를 기준으로 변경을 하고,\r\n     * 그렇지 않을 경우 첫번째 좌표를 기준으로 한다.\r\n     */\r\n    if (thirdPoint[0] >= offset.width) {\r\n      changedX1 = thirdPoint[0] - width\r\n      changedX3 = thirdPoint[0]\r\n    } else {\r\n      changedX1 = firstPoint[0]\r\n      changedX3 = firstPoint[0] + width\r\n    }\r\n\r\n    if (thirdPoint[1] >= offset.height) {\r\n      changedY1 = thirdPoint[1] - height\r\n      changedY3 = thirdPoint[1]\r\n    } else {\r\n      changedY1 = firstPoint[1]\r\n      changedY3 = firstPoint[1] + height\r\n    }\r\n\r\n    drawView.changeRectangle(changedX1, changedY1, changedX3, changedY3, true)\r\n    draw.changeAxis()\r\n  }\r\n  this.changeRectangle = function (x1, y1, x2, y2, flagForchangeFirstAxis) {\r\n    if (flagForchangeFirstAxis === true) {\r\n      draw.drawModel.setAxis(0, x1, y1)\r\n    }\r\n\r\n    draw.drawModel.setAxis(draw.rectangleIndex[1], x1, y2)\r\n    draw.drawModel.setAxis(draw.rectangleIndex[2], x2, y2)\r\n    draw.drawModel.setAxis(draw.rectangleIndex[3], x2, y1)\r\n  }\r\n  this.changeNormalStatus = function () {\r\n    var lines = draw.lineHelper.getLines()\r\n    var circles = draw.circleHelper.getCircles()\r\n\r\n    lines.forEach(function (line) {\r\n      draw.lineHelper.hide(line)\r\n    })\r\n\r\n    circles.forEach(function (circle) {\r\n      draw.circleHelper.hide(circle)\r\n    })\r\n\r\n    if (draw.useArrow === true) {\r\n      draw.arrowImageHelper.hide()\r\n    }\r\n\r\n    draw.textTagHelper.hide()\r\n\r\n    draw.resetAllColor()\r\n  }\r\n  this.changeActiveStatus = function () {\r\n    var lines = draw.lineHelper.getLines()\r\n    var circles = draw.circleHelper.getCircles()\r\n\r\n    lines.forEach(function (line) {\r\n      draw.lineHelper.show(line)\r\n    })\r\n\r\n    circles.forEach(function (circle) {\r\n      draw.circleHelper.show(circle)\r\n    })\r\n\r\n    if (draw.useArrow === true) {\r\n      draw.arrowImageHelper.show()\r\n    }\r\n\r\n    draw.textTagHelper.show()\r\n\r\n    draw.setAllColor()\r\n  }\r\n  this.validateGeometrySize = function (geometryWidth, geometryHeight) {\r\n    if (_.negate(_.isUndefined(draw.options.minSize))) {\r\n      if (geometryWidth < draw.options.minSize.width || geometryHeight < draw.options.minSize.height) {\r\n        return false\r\n      }\r\n    }\r\n\r\n    if (_.negate(_.isUndefined(draw.options.maxSize))) {\r\n      if (geometryWidth > draw.options.maxSize.width || geometryHeight > draw.options.maxSize.height) {\r\n        return false\r\n      }\r\n    }\r\n\r\n    return true\r\n  }\r\n}\r\n","'use strict'\r\n/**\r\n * SVG 태그에 옵션에 맞게 Polygon, Line을 추가한다.\r\n *\r\n * @example\r\nsvgGeometry.draw({\r\n  color: '#ff9832',\r\n  selectedColor: '#ff5732',\r\n  lineStrokeWidth: 5,\r\n  circleRadius: 8,\r\n  fill: true,\r\n  fillOpacity: 0,\r\n  useEvent: true,\r\n  points: [\r\n    [303,469],\r\n    [437,461],\r\n    [475,374],\r\n    [423,248],\r\n    [291,270],\r\n    [224,388],\r\n    [219,472]\r\n  ]\r\n});\r\n */\r\n/**\r\n * DrawModel\r\n *\r\n * DrawView - DrawController\r\n * ArrowImageView - ArrowImageController\r\n * CircleView - CircleController\r\n * GroupView - GroupController\r\n * IconView - IconController\r\n * LineView - LineController\r\n * PolygonView - PolygonController\r\n * TextView - TextController\r\n * WiseFaceDetectionView - WiseFaceDetectionController\r\n */\r\nconst FunnyMath = require('../../common/FunnyMath')\r\nconst DrawModel = require('./DrawModel')\r\nconst DrawView = require('./DrawView')\r\nconst _ = require('../../common/fp')\r\n\r\nmodule.exports = function Draw (rootSVG, options) {\r\n  var draw = this\r\n\r\n  var MINIMUM_ANGLE = 1\r\n\r\n  draw.options = _.merge({\r\n    fillColor: '#cccccc',\r\n    lineColor: '#cccccc',\r\n    pointColor: '#cccccc',\r\n    points: [ [0, 0], [100, 100] ],\r\n    lineStrokeWidth: 3,\r\n    circleRadius: 5,\r\n    minLineLength: 30,\r\n    textInCircle: null,\r\n    arrow: null,\r\n    useEvent: false,\r\n    useResizeRectangle: false,\r\n    notUseMoveTopLayer: false,\r\n    useCursor: false,\r\n    useOnlyRectangle: false,\r\n    useRectangleForCustomDraw: false,\r\n    fill: false,\r\n    fillOpacity: 0.5,\r\n    fixedRatio: false,\r\n    ratio: false,\r\n    event: {},\r\n    customDraw: false,\r\n    minSize: {\r\n      width: 30,\r\n      height: 30\r\n    },\r\n    maxSize: false,\r\n    minPoint: 4,\r\n    maxPoint: 8,\r\n    initCenter: false,\r\n    mirror: false,\r\n    flip: false,\r\n    notUseAutoChangeOfArrow: false,\r\n    wiseFaceDetection: false\r\n  }, options)\r\n\r\n  draw.useArrow = true\r\n\r\n  if (draw.options.arrow === null) {\r\n    draw.useArrow = false\r\n  } else if (draw.options.arrow.mode === '') {\r\n    draw.useArrow = false\r\n  }\r\n\r\n  if (draw.options.useOnlyRectangle === true) {\r\n    draw.options.fixedRatio = true\r\n  }\r\n\r\n  draw.drawModel = new DrawModel(draw, rootSVG)\r\n  draw.drawView = new DrawView(draw, rootSVG)\r\n\r\n  draw.rectangleIndex = draw.drawModel.getRectangleIndex()\r\n\r\n  draw.callCustomEvent = draw.drawView.callCustomEvent\r\n  draw.init = draw.drawView.init\r\n  draw.addPoint = draw.drawView.addPoint\r\n  draw.hide = draw.drawView.removeAllElement\r\n  draw.show = draw.drawView.appendDom\r\n  draw.active = draw.drawView.changeActiveStatus\r\n  draw.normal = draw.drawView.changeNormalStatus\r\n  draw.getData = function () {\r\n    return {\r\n      points: draw.drawModel.getPoints(),\r\n      arrow: draw.drawView.getArrow()\r\n    }\r\n  }\r\n  draw.reset = draw.drawView.reset\r\n  draw.destroy = draw.drawView.reset\r\n  draw.endDraw = draw.drawView.endDraw\r\n  draw.createArrow = draw.drawView.createArrow\r\n  draw.changeArrow = draw.drawView.changeArrow\r\n  draw.changeMinSizeOption = draw.drawModel.changeMinSizeOption\r\n  draw.changeMaxSizeOption = draw.drawModel.changeMaxSizeOption\r\n  draw.changeRectangleToSize = draw.drawView.changeRectangleToSize\r\n  draw.modifyPoints = draw.drawModel.modifyPoints\r\n  draw.alignCenter = draw.drawModel.alignCenter\r\n  draw.validateAxis = draw.drawModel.validateAxis\r\n  draw.stopEvent = draw.drawView.unbindEvent\r\n  draw.startEvent = draw.drawView.bindEvent\r\n  draw.moveTopLayer = draw.drawView.moveTopLayer\r\n  draw.changeWFDFillColor = draw.drawView.changeFillColor\r\n  draw.changeAxis = draw.drawView.changeAxis\r\n  draw.resetAllColor = function () {\r\n    draw.drawView.resetAllColor()\r\n    draw.drawModel.setIsAllSelectedState(false)\r\n  }\r\n  draw.setAllColor = function () {\r\n    draw.drawView.setAllColor()\r\n    draw.drawModel.setIsAllSelectedState(true)\r\n  }\r\n\r\n  draw.validateStabilization = validateStabilization\r\n  draw.validateIntersection = validateIntersection\r\n  draw.validateMinimumAngle = validateMinimumAngle\r\n\r\n  draw.drawView.init()\r\n\r\n  // @DrawUtil\r\n  function validateMinimumAngle (prevPoints) {\r\n    var points = []\r\n    var pointsLength = 0\r\n\r\n    try {\r\n      points = _.isUndefined(prevPoints)\r\n        ? _.clone(draw.drawModel.getPoints())\r\n        : _.clone(prevPoints)\r\n      pointsLength = points.length\r\n\r\n      /**\r\n       * 삼각형부터 체크\r\n       */\r\n      if (pointsLength >= 3 && draw.options.fill === true) {\r\n        var vertextAngle = Math.abs(FunnyMath.getVertextAngle(points[0], points[1], points[2]))\r\n        if (vertextAngle < MINIMUM_ANGLE) {\r\n          return false\r\n        }\r\n\r\n        _.loop(() => {\r\n          points.push(points.shift())\r\n        })(pointsLength)\r\n      }\r\n    } catch (e) {\r\n      console.warn(e)\r\n    }\r\n\r\n    return true\r\n  }\r\n\r\n  // @DrawUtil\r\n  function validateIntersection (prevPoints) {\r\n    var returnVal = true\r\n    var points = 0\r\n    var pointsLength = 0\r\n\r\n    // 고정비 사각형, 직각사각형, 라인은 교차 체크를 하지 않음.\r\n    if (draw.options.fill === false || draw.options.fixedRatio === true) {\r\n      return\r\n    }\r\n\r\n    try {\r\n      points = _.isUndefined(prevPoints)\r\n        ? _.clone(draw.drawModel.getPoints())\r\n        : _.clone(prevPoints)\r\n      pointsLength = points.length\r\n\r\n      for (var i = 0; i < pointsLength - 1; i++) {\r\n        var firstLineFirstPoint = points[i]\r\n        var firstLineSecondPoint = points[i + 1]\r\n\r\n        for (var j = i + 1; j < pointsLength; j++) {\r\n          var secondLineFirstPoint = points[j]\r\n          var secondLineSecondPointIndex = ((j + 1) === pointsLength ? 0 : (j + 1))\r\n          var secondLineSecondPoint = points[secondLineSecondPointIndex]\r\n\r\n          if (FunnyMath.checkLineIntersection(\r\n            firstLineFirstPoint[0],\r\n            firstLineFirstPoint[1],\r\n            firstLineSecondPoint[0],\r\n            firstLineSecondPoint[1],\r\n            secondLineFirstPoint[0],\r\n            secondLineFirstPoint[1],\r\n            secondLineSecondPoint[0],\r\n            secondLineSecondPoint[1]\r\n          ) === false) {\r\n            returnVal = false\r\n            break\r\n          }\r\n        }\r\n      }\r\n    } catch (e) {\r\n      console.info(e)\r\n    }\r\n\r\n    return returnVal\r\n  }\r\n\r\n  // @DrawUtil\r\n  function validateStabilization (prevPoints) {\r\n    var points = _.isUndefined(prevPoints)\r\n      ? _.clone(draw.drawModel.getPoints())\r\n      : _.clone(prevPoints)\r\n    var returnVal = true\r\n\r\n    if (validateMinimumAngle(points) === false || validateIntersection(points) === false) {\r\n      returnVal = false\r\n    }\r\n\r\n    return returnVal\r\n  }\r\n}","const Draw = require('../draw')\r\n\r\nconst convertRectanglePoints = (x1, y1, x2, y2) => {\r\n  return [\r\n    [x1, y1], [x1, y2], [x2, y2], [x2, y1]\r\n  ]\r\n}\r\n\r\nconst callStartEvent = (options, obj) => {\r\n  if ('start' in options.event) {\r\n    options.event.start(obj)\r\n  }\r\n}\r\n\r\nconst callEndEvent = (options, obj) => {\r\n  if ('end' in options.event) {\r\n    options.event.end(obj)\r\n  }\r\n}\r\n\r\nconst init = () => {\r\n  return {\r\n    obj: null,\r\n    currentPoint: 0,\r\n    options: null\r\n  }\r\n}\r\n\r\nconst start = (rootSVG, options, axis, currentPoint) => {\r\n  const obj = new Draw(rootSVG, options)\r\n  callStartEvent(options, obj)\r\n  currentPoint++\r\n\r\n  return {\r\n    obj,\r\n    currentPoint\r\n  }\r\n}\r\n\r\nconst end = (obj, options) => {\r\n  obj.endDraw()\r\n  callEndEvent(options, obj)\r\n  return init()\r\n}\r\n\r\nconst destroy = (obj) => {\r\n  obj.destory()\r\n  return init()\r\n}\r\n\r\nconst isFirst = (currentPoint) => currentPoint === 0\r\n\r\n/**\r\n * @todo\r\n * State 상속으로 사용했던 부분 함수로 교체\r\n */\r\nclass State {\r\n  constructor(rootSVG) {\r\n    const {\r\n      obj,\r\n      currentPoint,\r\n      options\r\n    } = init()\r\n    this._rootSVG = rootSVG\r\n    this._obj = obj\r\n    this._currentPoint = currentPoint\r\n    this._options = options\r\n  }\r\n\r\n  start(options, axis) {\r\n    this._options = options\r\n    const {\r\n      obj, currentPoint\r\n    } = start(this._rootSVG, options, axis, this._currentPoint)\r\n    this._obj = obj\r\n    this._currentPoint = currentPoint\r\n  }\r\n\r\n  end() {\r\n    const {\r\n      obj,\r\n      currentPoint,\r\n      options\r\n    } = end(this._obj, this._options)\r\n    this._obj = obj\r\n    this._currentPoint = currentPoint\r\n    this._options = options\r\n  }\r\n\r\n  add() {}\r\n  isLast() {}\r\n\r\n  isFirst() {\r\n    return isFirst(this._currentPoint)\r\n  }\r\n\r\n  destroy() {\r\n    const {\r\n      obj,\r\n      currentPoint,\r\n      options\r\n    } = destroy(this._obj)\r\n    this._obj = obj\r\n    this._currentPoint = currentPoint\r\n    this._options = options\r\n  }\r\n\r\n  convertRectanglePoints (...args) {\r\n    return convertRectanglePoints(...args)\r\n  }\r\n}\r\n\r\nmodule.exports = State","const State = require('./state')\r\n\r\nclass FixedRatioState extends State {\r\n  constructor(rootSVG) {\r\n    super(rootSVG)\r\n  }\r\n\r\n  start(options, axis) {\r\n    var points = []\r\n    if (options.minSize === false) {\r\n      points = this.convertRectanglePoints(\r\n        axis[0], axis[1],\r\n        axis[0] + options.ratio[0], axis[1] + options.ratio[1]\r\n      )\r\n    } else {\r\n      points = this.convertRectanglePoints(\r\n        axis[0], axis[1],\r\n        axis[0] + options.minSize.width, axis[1] + options.minSize.height\r\n      )\r\n    }\r\n    options.points = points\r\n\r\n    super.start(options, axis)\r\n  }\r\n\r\n  end() {\r\n    super.end()\r\n  }\r\n\r\n  isLast() {\r\n    return this._currentPoint !== 0\r\n  }\r\n}\r\n\r\n\r\nmodule.exports = FixedRatioState\r\n","const State = require('./state')\r\n\r\nclass RectangleState extends State {\r\n  constructor(rootSVG) {\r\n    super(rootSVG)\r\n  }\r\n\r\n  start(options, axis) {\r\n    options.points = this.convertRectanglePoints(axis[0], axis[1], axis[0], axis[1])\r\n    super.start(options, axis)\r\n  }\r\n\r\n  end() {\r\n    super.end()\r\n  }\r\n\r\n  isLast() {\r\n    return this._currentPoint !== 0\r\n  }\r\n}\r\n\r\nmodule.exports = RectangleState","const State = require('./state')\r\nconst FunnyMath = require('../../common/FunnyMath')\r\nconst _ = require('../../common/fp')\r\n\r\nclass LineState extends State {\r\n  constructor(rootSVG) {\r\n    super(rootSVG)\r\n  }\r\n\r\n  start(options, axis) {\r\n    options.points = [axis, axis]\r\n    super.start(options, axis)\r\n    this._currentPoint = 2\r\n  }\r\n\r\n  end() {\r\n    super.end()\r\n  }\r\n\r\n  add(axis) {\r\n    if (this.validateAllAxis(this._options.minLineLength) === false) {\r\n      return\r\n    }\r\n\r\n    if (this._currentPoint > 2) {\r\n      if (this._obj.validateStabilization() === false) {\r\n        return\r\n      }\r\n    }\r\n\r\n    this._obj.addPoint(axis[0], axis[1])\r\n    this._currentPoint++\r\n  }\r\n\r\n  isLast() {\r\n    if (this._currentPoint === this._options.minPoint) {\r\n      if (this.validateAllAxis(this._options.minLineLength) === false || this._obj.validateStabilization() === false) {\r\n        return false\r\n      }\r\n      return true\r\n    }\r\n    return false\r\n  }\r\n\r\n  validateAllAxis() {\r\n    var points = this._obj.getData().points\r\n    var pythagoreanTheorem = FunnyMath.pythagoreanTheorem\r\n\r\n    return !_.find((startAxis, index, points) => {\r\n      var endAxis = index === points.length - 1 ?\r\n        points[0] : points[index + 1]\r\n\r\n      if (pythagoreanTheorem(startAxis[0], startAxis[1], endAxis[0], endAxis[1]) < this._options.minLineLength) {\r\n        return true\r\n      }\r\n    })(points)\r\n  }\r\n}\r\n\r\n\r\nmodule.exports = LineState","'use strict'\r\nconst EventController = require('../../common/EventController')\r\nconst ElementController = require('../../common/ElementController')\r\nconst _ = require('../../common/fp')\r\nconst FixedRatioState = require('./fixed_ratio_state')\r\nconst RectangleState = require('./ractangle_state')\r\nconst LineState = require('./line_state')\r\nconst {MOVED_ATTR} = require('../../modules/constants')\r\n\r\n/**\r\n * 하고 싶은 것\r\n * OOP -> FP\r\n * 1. 모두 순수 함수로 변경\r\n * 2. 클로저 사용으로 변경\r\n * \r\n * 함수 실행 => 역할부여\r\n * 1. create instance\r\n * 2. bindevent\r\n * 3. trigger click\r\n * 4. bind cancel event\r\n * 5. trigger click\r\n * 6. unbind cancel event\r\n */\r\n\r\nconst getState = (options) => {\r\n  if (options.useOnlyRectangle === true) {\r\n    if (options.fixedRatio === true) {\r\n      return FixedRatioState\r\n    }\r\n    return RectangleState\r\n  }\r\n  return LineState\r\n}\r\n\r\nconst calibrateOptions = (options) => {\r\n  const newOptions = _.merge({\r\n    minPoint: 4,\r\n    event: {},\r\n    fixedRatio: false,\r\n    useOnlyRectangle: false,\r\n    ratio: false,\r\n    minLineLength: 20,\r\n    minSize: false\r\n  }, options)\r\n\r\n  newOptions.fixedRatio && (newOptions.useOnlyRectangle = true)\r\n  newOptions.customDraw = true\r\n\r\n  return newOptions\r\n}\r\n\r\nconst addEventListener = (element, eventName, eventListener) => {\r\n  EventController.bindEvent(eventName, eventListener)(element)\r\n\r\n  return () => {\r\n    EventController.unbindEvent(eventName, eventListener)(element)\r\n  }\r\n}\r\n\r\nconst bindEvent = (rootSVG, state, options) => {\r\n  let unbindContextMenu\r\n  let unbindESCkeyEvent\r\n  const bindContextMenu = () => {\r\n    return addEventListener(rootSVG, 'contextmenu', stopDrawing)\r\n  }\r\n  const bindESCkeyEvent = () => {\r\n    return addEventListener(document, 'keyup', ({keyCode}) => {\r\n      keyCode === 27 && (stopDrawing())\r\n    })\r\n  }\r\n  const stopDrawing  = () => {\r\n    if (state.isFirst() === false) {\r\n      state.destroy()\r\n      endDraw()\r\n    }\r\n  }\r\n\r\n  const startDraw = () => {\r\n    unbindContextMenu = bindContextMenu()\r\n    unbindESCkeyEvent = bindESCkeyEvent()\r\n  }\r\n\r\n  const endDraw = () => {\r\n    unbindContextMenu()\r\n    unbindESCkeyEvent()\r\n  }\r\n\r\n  return addEventListener(rootSVG, 'click', (event) => {\r\n    if (ElementController.getAttr(MOVED_ATTR)(rootSVG) === 'true') {\r\n      return\r\n    }\r\n    const axis = ElementController.getPageAxis(rootSVG, event)\r\n\r\n    if (state.isFirst()) {\r\n      startDraw()\r\n      state.start(options, axis)\r\n    } else if (state.isLast()) {\r\n      endDraw()\r\n      state.end()\r\n    } else {\r\n      state.add(axis)\r\n    }\r\n  })\r\n}\r\n\r\nmodule.exports = (rootSVG, _options) => {\r\n  const options = calibrateOptions(_options)\r\n  const StateConstructor = getState(options)\r\n  const state = new StateConstructor(rootSVG)\r\n  const unbindEvent = bindEvent(rootSVG, state, options)\r\n\r\n  return {\r\n    destroy: unbindEvent\r\n  }\r\n}\r\n","'use strict'\r\nconst CustomEditor = require('./customeditor')\r\nconst Draw = require('./draw')\r\nconst EventController = require('../common/EventController')\r\nconst ElementController = require('../common/ElementController')\r\nconst _ = require('../common/fp')\r\nconst {\r\n  MOVED_ATTR,\r\n  CLICK_DETECTION_TIME\r\n} = require('../modules/constants')\r\n\r\nclass CustomEditorV2 extends CustomEditor {\r\n  constructor(rootSVG, options) {\r\n    super(rootSVG, options)\r\n    this._mouseDownTimer = null\r\n    this._svgObj = null\r\n  }\r\n\r\n  unbindEvent() {\r\n    _.divEq(\r\n      EventController.unbindEvent('click', this.parentSVGClickHandle),\r\n      EventController.unbindEvent('mousedown', this.parentSVGMouseDownHandle),\r\n      EventController.unbindEvent('mouseup', this.parentSVGMouseUpHandle)\r\n    )(this._rootSVG)\r\n  }\r\n\r\n  createParentSVGClickHandle () {\r\n    const fn = super.createParentSVGClickHandle()\r\n    return (event) => {\r\n      this._options.useRectangleForCustomDraw = false\r\n      fn(event)\r\n    }\r\n  }\r\n\r\n  bindEvent() {\r\n    this.parentSVGMouseDownHandle = this.createParentSVGMouseDownHandle()\r\n    this.parentSVGMouseUpHandle = this.createParentSVGMouseUpHandle()\r\n    this.parentSVGClickHandle = this.createParentSVGClickHandle()\r\n\r\n    _.divEq(\r\n      EventController.bindEvent('mousedown', this.parentSVGMouseDownHandle),\r\n      EventController.bindEvent('mouseup', this.parentSVGMouseUpHandle)\r\n    )(this._rootSVG)\r\n  }\r\n\r\n  bindCancelEvent() {\r\n    this.bindContextMenu()\r\n    document.addEventListener('keyup', this.handleESCKey)\r\n  }\r\n\r\n  unbindCancelEvent() {\r\n    this.unbindContextMenu()\r\n    document.removeEventListener('keyup', this.handleESCKey)\r\n  }\r\n\r\n  removeDrawingGeometry() {\r\n    super.removeDrawingGeometry()\r\n    if (this._state.isFirst() === false) {\r\n      this.restartDrawing()\r\n    }\r\n  }\r\n\r\n  restartDrawing() {\r\n    this.unbindCancelEvent()\r\n    this.unbindEvent()\r\n    this.bindEvent()\r\n  }\r\n\r\n  endDraw() {\r\n    super.endDraw()\r\n    this.restartDrawing()\r\n  }\r\n\r\n  endDragEvent() {\r\n    this._svgObj.endDraw()\r\n    this.unbindCancelEvent()\r\n    this.restartDrawing()\r\n    this._svgObj = null\r\n  }\r\n\r\n  createParentSVGMouseUpHandle () {\r\n    return (event) => {\r\n      var isCheckingDragEvent = this._mouseDownTimer !== null\r\n\r\n      if (isCheckingDragEvent) {\r\n        this.abortCheckingDragEvent(event)\r\n        return\r\n      }\r\n\r\n      var isRightMouseBtn = event.buttons === 2\r\n      var isUsingParent = ElementController.getAttr(MOVED_ATTR)(this._rootSVG) === 'true'\r\n\r\n      if (isRightMouseBtn || isUsingParent || this._svgObj === null) {\r\n        return\r\n      }\r\n      this.endDragEvent()\r\n    }\r\n  }\r\n\r\n  abortCheckingDragEvent(event) {\r\n    window.clearTimeout(this._mouseDownTimer)\r\n    this._mouseDownTimer = null\r\n\r\n    this.parentSVGClickHandle(event)\r\n\r\n    _.divEq(\r\n      EventController.unbindEvent('mousedown', this.parentSVGMouseDownHandle),\r\n      EventController.unbindEvent('mouseup', this.parentSVGMouseUpHandle),\r\n      EventController.bindEvent('click', this.parentSVGClickHandle)\r\n    )(this._rootSVG)\r\n\r\n  }\r\n\r\n  createParentSVGMouseDownHandle () {\r\n    return (event) => {\r\n      const isRightMouseBtn = event.buttons === 2\r\n      const isNotCurrentTarget = event.currentTarget !== event.target\r\n      const isUsingParent = ElementController.getAttr(MOVED_ATTR)(this._rootSVG) === 'true'\r\n\r\n      if (isRightMouseBtn || isNotCurrentTarget || isUsingParent) {\r\n        return\r\n      }\r\n\r\n      this.startCheckingDragEvent(event)\r\n    }\r\n  }\r\n\r\n  startCheckingDragEvent(event) {\r\n    window.clearTimeout(this._mouseDownTimer)\r\n\r\n    this._mouseDownTimer = window.setTimeout((axis) => this.startDragEvent(axis),\r\n      CLICK_DETECTION_TIME,\r\n      ElementController.getPageAxis(this._rootSVG, event)\r\n    )\r\n  }\r\n\r\n  startDragEvent(axis) {\r\n    var DEFAULT_OBJECT_SIZE = 30\r\n    this._mouseDownTimer = null\r\n    this._options.points = [\r\n      axis, [axis[0], axis[1] + DEFAULT_OBJECT_SIZE],\r\n      [axis[0] + DEFAULT_OBJECT_SIZE, axis[1] + DEFAULT_OBJECT_SIZE],\r\n      [axis[0] + DEFAULT_OBJECT_SIZE, axis[1]]\r\n    ]\r\n\r\n    this._options.useRectangleForCustomDraw = true\r\n\r\n    this._svgObj = new Draw(this._rootSVG, this._options)\r\n    this.bindCancelEvent()\r\n  }\r\n}\r\n\r\n\r\nmodule.exports = CustomEditorV2\r\n","'use strict'\r\n/**\r\n * SVG를 사용한 Drawing 툴 모듈이다.\r\n * Plugin 중 'draw'를 통해서 영역을 조작한다.\r\n *\r\n * @class\r\n * @param {Object} rootSVG svg tag\r\n * @example\r\n<caption>HTML Resource</caption>\r\n<script src=\"./svg_drawing/modules/svg_geometry_product.js\"></script>\r\n<script src=\"./svg_drawing/modules/svg_geometry.js\"></script>\r\n\r\n<script src=\"./svg_drawing/plugins/draw/arrow-image-helper.js\"></script>\r\n<script src=\"./svg_drawing/plugins/draw/circle-helper.js\"></script>\r\n<script src=\"./svg_drawing/plugins/draw/group-helper.js\"></script>\r\n<script src=\"./svg_drawing/plugins/draw/icon-helper.js\"></script>\r\n<script src=\"./svg_drawing/plugins/draw/line-helper.js\"></script>\r\n<script src=\"./svg_drawing/plugins/draw/polygon-helper.js\"></script>\r\n<script src=\"./svg_drawing/plugins/draw/text-helper.js\"></script>\r\n<script src=\"./svg_drawing/plugins/draw/wise-facedetection-helper.js\"></script>\r\n<script src=\"./svg_drawing/plugins/draw/index.js\"></script>\r\n\r\n* @example\r\n<caption>HTML</caption>\r\n<svg\r\n  width=\"500\"\r\n  height=\"500\"\r\n  id=\"svg_polygon\"\r\n  xmlns=\"http://www.w3.org/2000/svg\"\r\n  xmlns:xlink=\"http://www.w3.org/1999/xlink\">\r\n</svg>\r\n\r\n * @example\r\n<caption>Javascript</caption>\r\nvar rootSVG = document.getElementById(\"svg_polygon\");\r\nvar svgGeometry = new SVGGeometry(rootSVG);\r\nsvgGeometry.draw({\r\n  color: '#ff9832',\r\n  selectedColor: '#ff5732',\r\n  lineStrokeWidth: 5,\r\n  circleRadius: 8,\r\n  fill: true,\r\n  fillOpacity: 0,\r\n  useEvent: true,\r\n  points: [\r\n    [303,469],\r\n    [437,461],\r\n    [475,374],\r\n    [423,248],\r\n    [291,270],\r\n    [224,388],\r\n    [219,472]\r\n  ]\r\n});\r\n */\r\nconst Draw = require('../plugins/draw')\r\nconst customEditor = require('../plugins/customeditor')\r\nconst CustomEditorV2 = require('../plugins/svg_geometry_plugin_customeditor_v2')\r\n\r\nconst ElementController = require('../common/ElementController')\r\nconst _ = require('../common/fp')\r\n\r\nclass SVGGeometry {\r\n  constructor (rootSVG) {\r\n    _.divEq(\r\n      ElementController.setAttr('draggable', false),\r\n      ElementController.style('cursor', 'normal'),\r\n      ElementController.style('userSelect', 'none'),\r\n      ElementController.style('mozUserSelect', 'none'),\r\n      ElementController.style('webkitUserSelect', 'none'),\r\n      ElementController.style('msUserSelect', 'none')\r\n    )(rootSVG)\r\n    this._rootSVG = rootSVG\r\n  }\r\n  draw (options) {\r\n    return new Draw(this._rootSVG, options)\r\n  }\r\n  customEditor (options) {\r\n    return customEditor(this._rootSVG, options)\r\n  }\r\n  customEditorV2 (options) {\r\n    return this.customEditor(options)\r\n    // return new CustomEditorV2(this._rootSVG, options)\r\n  }\r\n}\r\n\r\nmodule.exports = SVGGeometry\r\n","const SVGGeometry = require('../src/modules/svg_geometry')\r\n\r\nmodule.exports = function Polygon () {\r\n  var svgTag = document.getElementById('svg_polygon')\r\n  var svgGeometry = new SVGGeometry(svgTag)\r\n  var polygonObject = null\r\n\r\n  var draw = function () {\r\n    polygonObject = svgGeometry.draw({\r\n      fillColor: '#ff6633',\r\n      lineColor: '#ff6633',\r\n      pointColor: '#ff6633',\r\n      lineStrokeWidth: 5,\r\n      circleRadius: 6,\r\n      fill: true,\r\n      points: [\r\n        [156.5, 370],\r\n        [239.5, 304],\r\n        [321.5, 366],\r\n        [286.5, 271],\r\n        [370.5, 220],\r\n        [271.5, 221],\r\n        [238.5, 125],\r\n        [210.5, 222],\r\n        [114.5, 225],\r\n        [197.5, 272]\r\n      ],\r\n      minPoint: 2,\r\n      maxPoint: 10,\r\n      useEvent: true,\r\n      useCursor: true,\r\n      event: {\r\n        mouseup: getPoints,\r\n        polygoncontextmenu: function () {\r\n          alert('polygoncontextmenu')\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  var addPoint = function () {\r\n    polygonObject.addPoint()\r\n  }\r\n\r\n  function getPoints () {\r\n    var data = polygonObject.getData()\r\n    var log = document.getElementById('svg_polygon_log')\r\n    log.innerHTML = ''\r\n\r\n    for (var i = 0, len = data.points.length; i < len; i++) {\r\n      var self = data.points[i]\r\n      log.innerHTML += '[' + self[0] + ',' + self[1] + ']'\r\n\r\n      if (i < len - 1) {\r\n        log.innerHTML += ','\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    draw: draw,\r\n    addPoint: addPoint,\r\n    getPoints: getPoints\r\n  }\r\n}\r\n","const SVGGeometry = require('../src/modules/svg_geometry')\r\n\r\nmodule.exports = function Line(){\r\n\tvar svgTag = document.getElementById('svg_line');\r\n\tvar svgGeometry = new SVGGeometry(svgTag);\r\n\tvar lineObject = [];\r\n\r\n\tvar draw = function(){\r\n\t\tlineObject.push(svgGeometry.draw({\r\n\t\t\tlineColor: '#ff6633',\r\n\t\t\tpointColor: '#ff6633',\r\n\t\t\tlineStrokeWidth: 4,\r\n\t\t\tcircleRadius: 6,\r\n\t\t\tminPoint: 2,\r\n\t\t\tmaxPoint: 8,\r\n\t\t\tpoints: [\r\n\t\t\t\t[70,242],\r\n\t\t\t\t[362,380]\r\n\t\t\t],\r\n\t\t\tuseEvent: true\r\n\t\t}));\r\n\r\n\t\tlineObject.push(svgGeometry.draw({\r\n\t\t\tlineColor: '#ff6633',\r\n\t\t\tpointColor: '#ff6633',\r\n\t\t\tlineStrokeWidth: 4,\r\n\t\t\tcircleRadius: 6,\r\n\t\t\tminPoint: 2,\r\n\t\t\tmaxPoint: 8,\r\n\t\t\tpoints: [\r\n\t\t\t\t[70,270],\r\n\t\t\t\t[380,270]\r\n\t\t\t],\r\n\t\t\tuseEvent: true\r\n\t\t}));\r\n\r\n\t\tsvgGeometry.customEditor({\r\n\t\t\tlineColor: '#ff6633',\r\n\t\t\tpointColor: '#ff6633',\r\n\t\t\tlineStrokeWidth: 4,\r\n\t\t\tcircleRadius: 6,\r\n\t\t\tminPoint: 2,\r\n\t\t\tmaxPoint: 8,\r\n\t\t\tuseEvent: true\r\n\t\t});\r\n\t};\r\n\r\n\treturn {\r\n\t\tdraw: draw\r\n\t}\r\n}","const SVGGeometry = require('../src/modules/svg_geometry')\r\n\r\nmodule.exports = function FixedRatio(){\r\n\tvar svgTag = document.getElementById('svg_fixed_ratio');\r\n\tvar svgGeometry = new SVGGeometry(svgTag);\r\n\tvar kindSVGObj = [];\r\n\r\n\tvar draw = function(){\r\n\t\t//Bule\r\n\t\tkindSVGObj.push(svgGeometry.draw({\r\n\t\t\tfillColor: '#7fa9e3',\r\n\t\t\tlineColor: '#7fa9e3',\r\n\t\t\tpointColor: '#7fa9e3',\r\n\t\t\tlineStrokeWidth: 4,\r\n\t\t\tcircleRadius: 8,\r\n\t\t\tuseCursor: true,\r\n\t\t\tfill: true,\r\n\t\t\tpoints: [\r\n\t\t\t\t[10, 10],\r\n\t\t\t\t[10, 100],\r\n\t\t\t\t[130, 100],\r\n\t\t\t\t[130, 10]\r\n\t\t\t],\r\n\t\t\tfixedRatio: true,\r\n\t\t\tuseEvent: true\r\n\t\t}));\r\n\r\n\t\t//Red\r\n\t\tkindSVGObj.push(svgGeometry.draw({\r\n\t\t\tfillColor: '#e38d7f',\r\n\t\t\tlineColor: '#e38d7f',\r\n\t\t\tpointColor: '#e38d7f',\r\n\t\t\tlineStrokeWidth: 4,\r\n\t\t\tcircleRadius: 8,\r\n\t\t\tuseCursor: true,\r\n\t\t\tfill: true,\r\n\t\t\tpoints: [\r\n\t\t\t\t[200, 10],\r\n\t\t\t\t[200, 210],\r\n\t\t\t\t[400, 210],\r\n\t\t\t\t[400, 10]\r\n\t\t\t],\r\n\t\t\tfixedRatio: true,\r\n\t\t\tuseEvent: true\r\n\t\t}));\r\n\r\n\t\t//Green\r\n\t\tkindSVGObj.push(svgGeometry.draw({\r\n\t\t\tfillColor: '#7fe3a8',\r\n\t\t\tlineColor: '#7fe3a8',\r\n\t\t\tpointColor: '#7fe3a8',\r\n\t\t\tlineStrokeWidth: 4,\r\n\t\t\tcircleRadius: 8,\r\n\t\t\tuseCursor: true,\r\n\t\t\tfill: true,\r\n\t\t\tpoints: [\r\n\t\t\t\t[100, 250],\r\n\t\t\t\t[100, 430],\r\n\t\t\t\t[460, 430],\r\n\t\t\t\t[460, 250]\r\n\t\t\t],\r\n\t\t\tfixedRatio: true,\r\n\t\t\tuseEvent: true\r\n\t\t}));\r\n\t};\r\n\r\n\tfunction alignCenter(){\r\n\t\tfor(var i = 0, ii = kindSVGObj.length; i < ii; i++){\r\n\t\t\tkindSVGObj[i].alignCenter();\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tdraw: draw,\r\n\t\talignCenter: alignCenter\r\n\t};\r\n}","const SVGGeometry = require('./src/modules/svg_geometry')\r\nconst Polygon = require('./scripts/polygon.js')\r\nconst Line = require('./scripts/line.js')\r\nconst FixedRatio = require('./scripts/fixedratio.js')\r\n\r\nvar lineObject = null\r\nvar kindSVGDrawing = null\r\nwindow.onload = function () {\r\n  var polygon = new Polygon()\r\n  polygon.draw()\r\n  getElem('svg_polygon_add_point').onclick = polygon.addPoint\r\n  getElem('svg_polygon_get_point').onclick = polygon.getPoints\r\n\r\n  var fixedRatio = new FixedRatio()\r\n  fixedRatio.draw()\r\n  getElem('svg_fixed_ratio_btn').onclick = fixedRatio.alignCenter\r\n\r\n  var line = new Line()\r\n  line.draw()\r\n}\r\n\r\nfunction getElem (id) {\r\n  return document.getElementById(id)\r\n}\r\nvar colorFactory = {\r\n  red: '#CE534D',\r\n  blue: '#3184F9',\r\n  includeArea: {\r\n    fill: '#ff6633',\r\n    line: '#ff6633',\r\n    point: '#ff6633'\r\n  },\r\n  excludeArea: {\r\n    fill: '#000000',\r\n    line: '#ffffff',\r\n    point: '#999999'\r\n  }\r\n}\r\nfunction getROIOptions () {\r\n  return {\r\n    fillColor: colorFactory.includeArea.fill,\r\n    lineColor: colorFactory.includeArea.line,\r\n    pointColor: colorFactory.includeArea.point,\r\n    lineStrokeWidth: 4,\r\n    circleRadius: 5,\r\n    useEvent: true,\r\n    useCursor: true,\r\n    minPoint: 4,\r\n    maxPoint: 8,\r\n    fill: true,\r\n    fillOpacity: '0.2'\r\n  }\r\n}\r\n\r\nfunction getLineOptions () {\r\n  return {\r\n    fillColor: colorFactory.includeArea.fill,\r\n    lineColor: colorFactory.includeArea.line,\r\n    pointColor: colorFactory.includeArea.point,\r\n    lineStrokeWidth: 4,\r\n    circleRadius: 6,\r\n    useEvent: true,\r\n    useCursor: true,\r\n    minPoint: 2,\r\n    maxPoint: 8,\r\n    arrow: {\r\n      mode: 'R',\r\n      min: 'L',\r\n      max: 'LR',\r\n      text: true\r\n    }\r\n  }\r\n}\r\n\r\nwindow.addEventListener('load', function () {\r\n  // [MD, IVA] ROI\r\n  var roi = document.getElementById('roi')\r\n  var roiEditor = new SVGGeometry(roi)\r\n  var roiOptions = getROIOptions()\r\n  var roiObj = []\r\n  var selectROIObj = function (obj) {\r\n    for (var i = 0, ii = roiObj.length; i < ii; i++) {\r\n      roiObj[i].normal()\r\n    }\r\n\r\n    obj.active()\r\n  }\r\n  var defaultROIPoints = [\r\n    [\r\n      [686, 319],\r\n      [455, 333],\r\n      [465, 467],\r\n      [694, 459]\r\n    ],\r\n    [\r\n      [294, 46],\r\n      [135, 55],\r\n      [150, 216],\r\n      [367, 194]\r\n    ]\r\n  ]\r\n  roiOptions.event = {\r\n    start: function () {\r\n\r\n    },\r\n    end: function (obj) {\r\n      roiObj.push(obj)\r\n      selectROIObj(obj)\r\n    },\r\n    mouseup: function () {\r\n      var self = this\r\n      // 포인트가 추가된뒤에 active 효과를 적용\r\n      setTimeout(function () {\r\n        selectROIObj(self)\r\n      })\r\n    }\r\n  }\r\n\r\n  roiEditor.customEditorV2(roiOptions)\r\n  for (var i = 0, ii = defaultROIPoints.length; i < ii; i++) {\r\n    roiOptions.points = defaultROIPoints[i]\r\n    roiObj.push(roiEditor.draw(roiOptions))\r\n  }\r\n  selectROIObj(roiObj[0])\r\n\r\n  // [IVA] Virtual Line\r\n  var virtualLine = document.getElementById('virtual_line')\r\n  var virtualLineEditor = new SVGGeometry(virtualLine)\r\n  var virtualLineOptions = getLineOptions()\r\n  virtualLineOptions.fillColor = colorFactory.blue\r\n  virtualLineOptions.lineColor = colorFactory.blue\r\n  virtualLineOptions.pointColor = colorFactory.blue\r\n  var virtualLineObj = []\r\n  var defaultVirtualLinePoints = [\r\n    [\r\n      [736, 146],\r\n      [455, 333]\r\n    ],\r\n    [\r\n      [651, 332],\r\n      [295, 152]\r\n    ]\r\n  ]\r\n  var selectLineObj = function (obj) {\r\n    for (var i = 0, ii = virtualLineObj.length; i < ii; i++) {\r\n      virtualLineObj[i].normal()\r\n    }\r\n\r\n    obj.active()\r\n  }\r\n  virtualLineOptions.event = {\r\n    start: function () {},\r\n    end: function (obj) {\r\n      virtualLineObj.push(obj)\r\n      selectLineObj(obj)\r\n    },\r\n    mouseup: function () {\r\n      var self = this\r\n      setTimeout(function () {\r\n        selectLineObj(self)\r\n      })\r\n    }\r\n  }\r\n  virtualLineEditor.customEditor(virtualLineOptions)\r\n  for (var i = 0, ii = defaultVirtualLinePoints.length; i < ii; i++) {\r\n    virtualLineOptions.points = defaultVirtualLinePoints[i]\r\n    virtualLineObj.push(virtualLineEditor.draw(virtualLineOptions))\r\n  }\r\n  selectLineObj(virtualLineObj[0])\r\n})\r\n"]}